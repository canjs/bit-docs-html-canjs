<!DOCTYPE html>
<!--####################################################################
	THIS IS A GENERATED FILE -- ANY CHANGES MADE WILL BE OVERWRITTEN

	INSTEAD CHANGE:
	source: [object Object]
	@page guides/recipes/todomvc-with-steal
######################################################################## -->
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>CanJS - TodoMVC with StealJS</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	
		<link rel="stylesheet" type="text/css" href="../../static/bundles/bit-docs-site/static.css">
		<link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64" href="/docs/images/canjs_favicon.ico">
		<link rel="apple-touch-icon" sizes="57x57" href="../../../docs/images/canjs_favicon_57x57.png">
		<link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../../docs/images/canjs_favicon_57x57.png">
		<link rel="apple-touch-icon" sizes="72x72" href="../../../docs/images/canjs_favicon_72x72.png">
		<link rel="apple-touch-icon" sizes="114x114" href="../../../docs/images/canjs_favicon_114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="../../../docs/images/canjs_favicon_128x128.png">
		<link rel="apple-touch-icon" sizes="144x144" href="../../../docs/images/canjs_favicon_144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="../../../docs/images/canjs_favicon_152x152.png">
		<meta content="yes" name="apple-mobile-web-app-capable">
	  	<meta name="apple-mobile-web-app-status-bar-style" content="white-translucent">
	
	
		<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-2302003-11', 'auto');
			ga('send', 'pageview');
		</script>
	
</head>
	<body>
		<input type="checkbox" id="nav-trigger" class="nav-trigger"/>
		<label for="nav-trigger">Menu</label>
	  	<div id="everything">
  <div id="left" class="column">
    <div class="top-left">
      
          <div class="brand">
	<div class="logo">
		<a href="../../../index.html" alt="CanJS"></a>
		<div class="dropdown project-dropdown">
			<a href="https://donejs.com/">DoneJS</a>
			<a href="https://stealjs.com/">StealJS</a>
			<a href="https://jquerypp.com/">jQuery++</a>
			<a href="https://funcunit.com/">FuncUnit</a>
			<a href="https://documentjs.com/">DocumentJS</a>
		</div>
	</div>
	<div class="version">
		<div class="version-number">
			3.8.1
		</div>
		<div class="dropdown version-dropdown">
			
				<a href="https://v2.canjs.com">2.3.27</a>
			
		</div>
	</div>
</div>
<div class="search-bar">
	<div class="search-wrap" style="display:none;">
		<span class="search-icon"></span>
		<input
			type="text"
			size="6"
			class="search"
			placeholder="Search"
			autocomplete="off"
			autocorrect="off"
			autocapitalize="none"
			spellcheck="false"/>
			<span class="search-icon-cancel"></span>
	</div>
</div>


      
    </div>
    <div class="bottom-left">
       <div class="social-side-container">
        <ul class="social-side">
  <li>
    <a class="header-mobile github" href="https://github.com/canjs/canjs" target="_blank"><img class="social-icon-small" src="../../../docs/images/github.png">Github</a>
  </li>
  <li>
    <a class="header-mobile twitter" href="https://twitter.com/canjs" target="_blank"><img class="social-icon-small" src="../../../docs/images/twitter.png">Twitter</a>
  </li>
</ul>
<ul class="social-side">
  <li>
    <a class="header-mobile" href="https://gitter.im/canjs/canjs" target="_blank">Chat</a>
  </li>
  <li>
    <a class="header-mobile" href="http://forums.donejs.com/c/canjs" target="_blank">Forum</a>
  </li>
</ul>

      </div>
        
            
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../about.html"
							title="Welcome to CanJS! Learn about CanJS’s mission &amp; technical highlights, who uses CanJS, and our future roadmap.">
							About
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						parent
           						expanded">
						<a class="page"
							href="../../guides.html"
							title="Welcome to CanJS! These guides are here to help you develop and improve your relationship with CanJS. After all, picking a JavaScript framework is a commitment.  We want CanJS to be the framework you marry.  This page helps you know how to advance through the different stages of this relationship:">
							Guides
						</a>
						
	<ul>
		
			
				
					<li>
						<span>experiment</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../chat.html"
							title="This guide will walk you through building a real-time chat application with CanJS’s Core libraries.  It takes about 30 minutes to complete.">
							Chat Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../todomvc.html"
							title="This guide will walk you through building a slightly modified version of TodoMVC with CanJS’s Core libraries and can-fixture. It takes about 1 hour to complete.">
							TodoMVC Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../atm.html"
							title="This guide will walk you through building and testing an Automated Teller Machine (ATM) application with CanJS’s
Core libraries.  You’ll learn how to do test driven development (TDD)
and manage complex state.  It takes about 2 hours to complete.">
							ATM Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../setup.html"
							title="Get started with CanJS by installing it with npm, using a JS&amp;nbsp;Bin, or just adding it to an HTML page with a &lt;script&gt; tag.">
							Setting up CanJS
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li>
						<span>commitment</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../api.html"
							title="This page walks through how to use and understand CanJS’s API documentation.">
							API Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../migrate-3.html"
							title="This guide walks you through the step-by-step process to upgrade a 2.x app to CanJS 3.">
							Migrating to CanJS 3
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						parent
           						expanded">
						<a class="page"
							href="../recipes.html"
							title="A listing of small examples that are useful for learning CanJS.">
							Recipes
						</a>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="file-navigator-advanced.html"
							title="This guide walks you through building a file navigation widget.  It takes about 45 minutes to complete.  It was written with
CanJS 3.4. Checkout the file-navigator-simple
for an easier example that produces similar functionality.">
							File Navigator Guide (Advanced)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="file-navigator-simple.html"
							title="This guide walks you through building a simple file navigation widget.  It takes about 25 minutes to complete.  It was written with
CanJS 3.4. Checkout the file-navigator-advanced
for an example that makes AJAX requests for its data and uses can-component.">
							File Navigator Guide (Simple)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="playlist-editor.html"
							title="Learn how to use YouTube&#x27;s API to search for videos and make a playlist.  This makes authenticated requests with OAuth2. It uses jQuery++ for
drag/drop events. It shows using custom attributes and custom events.  This guide takes
an hour to complete.">
							Playlist Editor (Advanced)
						</a>
						

					</li>
				
			
		
			
				
					<li class="current
           						parent
           						expanded">
						<a class="page"
							href="todomvc-with-steal.html"
							title="This guide walks through building TodoMVC with StealJS.">
							TodoMVC with StealJS
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="weather-report-advanced.html"
							title="This guides you through extending the Simple Weather Report Guide to remove imperative code and automatically look up the user’s location using the
browser’s geolocation API.  Both of these will be done with event streams.
This guide continues where the Simple Weather Report Guide left off.  It takes about 25 minutes to complete.  It was written with CanJS 3.8.">
							Weather Report Guide (Advanced)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="weather-report-simple.html"
							title="This guide walks you through building a simple weather report widget.  It takes about 25 minutes to complete.  It was written with
CanJS 3.5.">
							Weather Report Guide (Simple)
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li>
						<span>contribute</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/adding-ecosystem-modules.html"
							title="Learn how to add your module to this site.">
							New Package
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/bug-report.html"
							title="Learn how to submit a bug report.">
							Bug Report
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/code.html"
							title="Learn how contribute a code change to CanJS.">
							Code
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/documentation.html"
							title="Learn how to improve CanJS’s site and documentation.">
							Documentation
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/evangelism.html"
							title="Learn about resources that can help you spread the word about CanJS.">
							Evangelism
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/feature-suggestion.html"
							title="Learn how to suggest a feature.">
							Feature Suggestion
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/releases.html"
							title="Release and hosting information for CanJS maintainers.">
							Releases
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../api.html"
							title="Welcome to the CanJS docs! Learn about all the packages that make-up CanJS &amp; how they work together to help you build amazing applications!">
							API Docs
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../community.html"
							title="Get involved with one of the most inviting communities on the internet!">
							Community
						</a>
						

					</li>
				
			
		
	</ul>


        
        <div class="search-results-container">
	<div class="search-results-wrap"></div>
</div>

    </div>
  </div>
  <div id="right" class="column">
    <div class="top-right">
      <div class="top-right-top">
	<ul class="top-right-bitovi">
	  	<li class="dropdown">
	    	<a href="https://www.bitovi.com" class="bitovi icon-bits">Bitovi</a>
	    	<ul class="dropdown-menu">
	      		<li><a href="https://www.bitovi.com/">Bitovi.com</a></li>
	      		<li><a href="https://www.bitovi.com/blog">Blog</a></li>
	      		<li><a href="https://www.bitovi.com/design">Design</a></li>
	      		<li><a href="https://www.bitovi.com/development">Development</a></li>
	      		<li><a href="https://www.bitovi.com/training">Training</a></li>
	      		<li><a href="https://www.bitovi.com/open-source">Open Source</a></li>
	      		<li><a href="https://www.bitovi.com/about">About</a></li>
	      		<li><a href="https://www.bitovi.com/contact">Contact Us</a></li>
	    	</ul>
	  	</li>
	</ul>
	<div class="brand">
		<div class="logo">
			<a href="../../../index.html" alt="CanJS"></a>
		</div>
	</div>
	<ul class="top-right-links">
  <li>
    <a href="https://gitter.im/canjs/canjs">Chat</a>
  </li>
  <li>
    <a href="http://forums.donejs.com/c/canjs">Forum</a>
  </li>
  <li>
    <a class="github-button nav-social" href="https://github.com/canjs/canjs" data-count-href="/canjs/canjs/stargazers" data-count-api="/repos/canjs/canjs#stargazers_count">Star</a>
  </li>
  <li>
    <a href="https://twitter.com/canjs" class="twitter-follow-button nav-social" data-show-count="true" data-show-screen-name="false">Follow @canjs</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </li>
</ul>
</div>
<div class="breadcrumb">
	
		<li><a href="../../../index.html">CanJS</a></li>
		<li> / </li>
	
		<li><a href="../../guides.html">Guides</a></li>
		<li> / </li>
	
		<li><a href="../recipes.html">Recipes</a></li>
		<li> / </li>
	
	
	<li><a href="todomvc-with-steal.html">TodoMVC with StealJS</a></li>
	
	<li class="breadcrumb-dropdown-separator"> / </li>
	<li class="breadcrumb-dropdown">
		<a> On this page</a>
		<ul class="on-this-page"></ul>
	</li>
	<div class="nav-toggle" title="Back to top"></div>
</div>


    </div>
    <div class="bottom-right">
      <article>
  <section class="title">
	<div class="page-type">
		<h1>TodoMVC with StealJS</h1>
			<ul class="title-social">
				
				
				<li>
					<a class="button-link" href="//github.com/canjs/canjs/edit/master/docs/can-guides/commitment/recipes/todomvc-with-steal/todomvc-with-steal.md">Edit on GitHub</a>
				</li>
				
			</ul>
	</div>
	<div class="clear-both"></div>
	
  
	<section class="description">
    <p>This guide walks through building TodoMVC with StealJS.</p>

</section>

  
	
</section>
<section class="on-this-page-table">
</section>











  
    <section class="body">
    <h2>Setup (Framework Overview)</h2>
<h3>The problem</h3>
<ul>
<li>Setup steal to load a basic CanJS application.  A basic CanJS application has:
<ul>
<li>A <a href="../../can-define/map/map.html" title="Create observable objects.">can-define/map/map</a> ViewModel and an instance of that ViewModel.</li>
<li>A <a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a> view that is rendered with the instance of the ViewModel.</li>
</ul></li>
<li>In addition, this application should load the <a href="https://www.npmjs.com/package/can-todomvc-test">can-todomvc-test</a> module and
pass it the application's <code>ViewModel</code> instance.</li>
</ul>
<h3>What you need to know</h3>
<ul>
<li><p>To create a new project with StealJS, run:</p>
<pre><code>npm init
npm install steal steal-tools steal-css --save-dev
</code></pre></li>
<li><p>To host static files, install <code>http-server</code> and run it like:</p>
<pre><code>npm install http-server -g
http-server -c-1
</code></pre></li>
<li><p>If you load StealJS plugins, add them to your <em>package.json</em> configuration like:</p>
<pre><code>&quot;steal&quot;: {
  &quot;plugins&quot;: [
    &quot;steal-css&quot;
  ]
}
</code></pre></li>
<li><p>Define a ViewModel type with <a href="../../can-define/map/map.html" title="Create observable objects.">can-define/map/map</a>:</p>
<pre><code class="language-js">var DefineMap = require(&quot;can-define/map/&quot;);
var Type = DefineMap.extend({ ... });
</code></pre></li>
<li><p>Create an instance of a ViewModel by using <code>new Type(props)</code>:</p>
<pre><code class="language-js">var instance = new Type({ ... });
</code></pre></li>
<li><p>Load a view with the <a href="../../steal-stache.html" title="A StealJS extension that allows stache templates as dependencies.">steal-stache</a> plugin like:</p>
<pre><code class="language-js">var view = require(&quot;./path/to/template.stache&quot;);
</code></pre>
<p>Note that <a href="../../steal-stache.html" title="A StealJS extension that allows stache templates as dependencies.">steal-stache</a> is a StealJS plugin and needs to be configured as such.</p></li>
<li><p>Render a view (or <code>template</code>) by passing it data.  It returns a document fragment that can<br />
be inserted into the page like:</p>
<pre><code class="language-js">var frag = view(appVM);
document.body.appendChild(frag);
</code></pre></li>
<li><p>Use the following HTML that a designer might have provided:</p>
<pre><code class="language-html">&lt;section id=&quot;todoapp&quot;&gt;
    &lt;header id=&quot;header&quot;&gt;
        &lt;h1&gt;Todos&lt;/h1&gt;
        &lt;input id=&quot;new-todo&quot; placeholder=&quot;What needs to be done?&quot;&gt;
    &lt;/header&gt;
    &lt;section id=&quot;main&quot; class=&quot;&quot;&gt;
        &lt;input id=&quot;toggle-all&quot; type=&quot;checkbox&quot;&gt;
        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;
        &lt;ul id=&quot;todo-list&quot;&gt;
            &lt;li class=&quot;todo&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;&gt;
                    &lt;label&gt;Do the dishes&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;Do the dishes&quot;&gt;
            &lt;/li&gt;
            &lt;li class=&quot;todo completed&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;&gt;
                    &lt;label&gt;Mow the lawn&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;Mow the lawn&quot;&gt;
            &lt;/li&gt;
            &lt;li class=&quot;todo editing&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;&gt;
                    &lt;label&gt;Pick up dry cleaning&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;Pick up dry cleaning&quot;&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
    &lt;/section&gt;
    &lt;footer id=&quot;footer&quot; class=&quot;&quot;&gt;
        &lt;span id=&quot;todo-count&quot;&gt;
            &lt;strong&gt;2&lt;/strong&gt; items left
        &lt;/span&gt;
        &lt;ul id=&quot;filters&quot;&gt;
            &lt;li&gt;
                &lt;a class=&quot;selected&quot; href=&quot;#!&quot;&gt;All&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!active&quot;&gt;Active&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!completed&quot;&gt;Completed&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;button id=&quot;clear-completed&quot;&gt;
            Clear completed (1)
        &lt;/button&gt;
    &lt;/footer&gt;
&lt;/section&gt;
</code></pre></li>
<li><p>Use <a href="https://www.npmjs.com/package/can-todomvc-test">can-todomvc-test</a> to load the application's
styles and run its tests:</p>
<pre><code class="language-js">require(&quot;can-todomvc-test&quot;)(appVM);
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Create a folder:</p>
<pre><code class="language-cmd">mkdir todomvc
cd todomvc
</code></pre>
<p>Host it:</p>
<pre><code>npm install http-server -g
http-server -c-1
</code></pre>
<p>Create a new project:</p>
<pre><code class="language-cmd">npm init
</code></pre>
<p>Hit <code>Enter</code> to accept the defaults.</p>
<p>Install <code>steal</code>, <code>steal-tool</code>, and CanJS's core modules:</p>
<pre><code class="language-cmd">npm install steal steal-tools steal-css --save-dev
npm install can-define can-stache steal-stache --save
</code></pre>
<p>Add <strong>steal.plugins</strong> to <em>package.json</em>:</p>
<pre><code class="language-json">{
  &quot;name&quot;: &quot;todomvc&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;description&quot;: &quot;&quot;,
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;
  },
  &quot;author&quot;: &quot;&quot;,
  &quot;license&quot;: &quot;MIT&quot;,
  &quot;devDependencies&quot;: {
    &quot;steal&quot;: &quot;^1.3.0&quot;,
    &quot;steal-css&quot;: &quot;^1.2.1&quot;,
    &quot;steal-tools&quot;: &quot;^1.2.0&quot;
  },
  &quot;dependencies&quot;: {
    &quot;can-define&quot;: &quot;^1.0.16&quot;,
    &quot;can-stache&quot;: &quot;^3.0.20&quot;,
    &quot;steal-stache&quot;: &quot;^3.0.5&quot;
  },
  &quot;steal&quot;: {
    &quot;plugins&quot;: [
      &quot;steal-stache&quot;, &quot;steal-css&quot;
    ]
  }
}

</code></pre>
<p><span line-highlight='21-25'></span></p>
<p>Create the starting HTML page:</p>
<pre><code class="language-html">&lt;!-- index.html --&gt;
&lt;script src=&quot;./node_modules/steal/steal.js&quot;&gt;&lt;/script&gt;
</code></pre>
<p>Create the application template:</p>
<pre><code class="language-html">&lt;!-- index.stache --&gt;
&lt;section id=&quot;todoapp&quot;&gt;
    &lt;header id=&quot;header&quot;&gt;
        &lt;h1&gt;{{appName}}&lt;/h1&gt;
        &lt;input id=&quot;new-todo&quot; placeholder=&quot;What needs to be done?&quot;&gt;
    &lt;/header&gt;
    &lt;section id=&quot;main&quot; class=&quot;&quot;&gt;
        &lt;input id=&quot;toggle-all&quot; type=&quot;checkbox&quot;&gt;
        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;
        &lt;ul id=&quot;todo-list&quot;&gt;
            &lt;li class=&quot;todo&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;&gt;
                    &lt;label&gt;Do the dishes&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;Do the dishes&quot;&gt;
            &lt;/li&gt;
            &lt;li class=&quot;todo completed&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;&gt;
                    &lt;label&gt;Mow the lawn&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;Mow the lawn&quot;&gt;
            &lt;/li&gt;
            &lt;li class=&quot;todo editing&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;&gt;
                    &lt;label&gt;Pick up dry cleaning&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;Pick up dry cleaning&quot;&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
    &lt;/section&gt;
    &lt;footer id=&quot;footer&quot; class=&quot;&quot;&gt;
        &lt;span id=&quot;todo-count&quot;&gt;
            &lt;strong&gt;2&lt;/strong&gt; items left
        &lt;/span&gt;
        &lt;ul id=&quot;filters&quot;&gt;
            &lt;li&gt;
                &lt;a class=&quot;selected&quot; href=&quot;#!&quot;&gt;All&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!active&quot;&gt;Active&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!completed&quot;&gt;Completed&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;button id=&quot;clear-completed&quot;&gt;
            Clear completed (1)
        &lt;/button&gt;
    &lt;/footer&gt;
&lt;/section&gt;

</code></pre>
<p>Install the test harness:</p>
<pre><code class="language-cmd">npm install can-todomvc-test --save-dev
</code></pre>
<p>Create the main app</p>
<pre><code class="language-js">// index.js
var view = require(&quot;./index.stache&quot;);
var DefineMap = require(&quot;can-define/map/&quot;);


var AppViewModel = DefineMap.extend(&quot;AppViewModel&quot;,{
    appName: &quot;string&quot;
});

var appVM = window.appVM = new AppViewModel({
    appName: &quot;TodoMVC&quot;
});

var frag = view(appVM);
document.body.appendChild(frag);

require(&quot;can-todomvc-test&quot;)(appVM);

</code></pre>
<h2>Define Todo type (DefineMap basics)</h2>
<h3>The problem</h3>
<ul>
<li>Define a <code>Todo</code> type as the export of  <em>models/todo.js</em>, where:
<ul>
<li>It is a <a href="../../can-define/map/map.html" title="Create observable objects.">can-define/map/map</a> type.</li>
<li>The id or name property values are coerced into a string.</li>
<li>Its <code>complete</code> property is a <code>Boolean</code> that defaults to <code>false</code>.</li>
<li>It has a <code>toggleComplete</code> method that flips <code>complete</code> to the opposite value.</li>
</ul></li>
</ul>
<p>Example test code:</p>
<pre><code class="language-js">var todo = new Todo({id: 1, name: 2});
QUnit.equal(todo.id, &quot;1&quot;, &quot;id is a string&quot;);
QUnit.equal(todo.name, &quot;2&quot;, &quot;name is a string&quot;);
QUnit.equal(todo.complete, false, &quot;complete defaults to false&quot;);
todo.toggleComplete();
QUnit.equal(todo.complete, true, &quot;toggleComplete works&quot;);
</code></pre>
<h3>What you need to know</h3>
<ul>
<li><p><a href="https://drive.google.com/open?id=0Bx-kNqf-wxZeUmlrN2p0Yi1qUzg">DefineMap Basics Presentation</a></p></li>
<li><p><a href="../../can-define/map/map.extend.html" title="Define a custom map type.">DefineMap.extend</a> defines a new <code>Type</code>.</p></li>
<li><p>The <a href="../../can-define.types.type.html" title="Converts a value set on an instance into an appropriate value.">type</a> behavior defines a property's type like:</p>
<pre><code class="language-js">DefineMap.extend({
    propertyName: {type: &quot;number&quot;}
})
</code></pre></li>
<li><p>The <a href="../../can-define.types.value.html" title="Returns the default value for instances of the defined type.  The default value is defined on demand, when the property
is read for the first time.">value</a> behavior defines a property's initial value like:</p>
<pre><code class="language-js">DefineMap.extend({
    propertyName: {value: 3}
})
</code></pre></li>
<li><p>Methods can be defined directly on the prototype like:</p>
<pre><code class="language-js">DefineMap.extend({
    methodName: function(){}
})
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Update <em>models/todo.js</em> to:</p>
<pre><code class="language-js">// models/todo.js
var DefineMap = require(&quot;can-define/map/&quot;);

var Todo = DefineMap.extend(&quot;Todo&quot;, {
    id: &quot;string&quot;,
    name: &quot;string&quot;,
    complete: {
        type: &quot;boolean&quot;,
        value: false
    },
    toggleComplete: function() {
        this.complete = !this.complete;
    }
});

module.exports = Todo;

</code></pre>
<h2>Define Todo.List type (DefineList basics)</h2>
<h3>The problem</h3>
<ul>
<li>Define a <code>Todo.List</code> type on the export of  <em>models/todo.js</em>, where:
<ul>
<li>It is a <a href="../../can-define/list/list.html" title="Create observable lists.">can-define/list/list</a> type.</li>
<li>The enumerable indexes are coerced into <code>Todo</code> types.</li>
<li>Its <code>.active</code> property returns a filtered <code>Todo.List</code> of the todos that are <strong>not</strong> complete.</li>
<li>Its <code>.complete</code> property returns a filtered <code>Todo.List</code> of the todos that are complete.</li>
<li>Its <code>.allComplete</code> property true if all the todos are complete.</li>
</ul></li>
</ul>
<p>Example test code:</p>
<pre><code class="language-js">QUnit.ok(Todo.List, &quot;Defined a List&quot;);
var todos = new Todo.List([{complete: true},{},{complete: true}]);
QUnit.ok(todos[0] instanceof Todo, &quot;each item in a Todo.List is a Todo&quot;);
QUnit.equal(todos.active.length, 1);
QUnit.equal(todos.complete.length, 2);
QUnit.equal(todos.allComplete, false, &quot;not allComplete&quot;);
todos[1].complete = true;
QUnit.equal(todos.allComplete, true, &quot;allComplete&quot;);
</code></pre>
<h3>What you need to know</h3>
<ul>
<li><p><a href="https://drive.google.com/open?id=0Bx-kNqf-wxZeRFUzclNhTlRjMDg">DefineList Basics Presentation</a></p></li>
<li><p><a href="../../can-define/list/list.extend.html" title="Define a custom list type.">DefineList.extend</a> defines a new <code>ListType</code>.</p></li>
<li><p>The <a href="../../can-define/list/list.prototype.wildcardItems.html" title="Define default behavior for items in the list.">#</a> property defines the behavior of items in a list like:</p>
<pre><code class="language-js">DefineList.extend({
    #: {type: ItemType}
})
</code></pre></li>
<li><p>The <a href="../../can-define.types.get.html" title="Specify what happens when a certain property is read on a map. get functions
work like a can-compute and automatically update themselves when a dependent
observable value is changed.">get</a> behavior defines observable computed properties like:</p>
<pre><code class="language-js">DefineMap.extend({
    propertyName: {
        get: function(){
            return this.otherProperty;
        }
    }
})
</code></pre></li>
<li><p><a href="../../can-define/list/list.prototype.filter.html" title="Filter a list to a new list of the matched items.">filter</a> can be used to filter a list into a new list:</p>
<pre><code class="language-js">list = new ListType([...]);
list.filter(function(item){
    return test(item);
})
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Update <em>models/todo.js</em> to the following:</p>
<pre><code class="language-js">// models/todo.js
var DefineMap = require(&quot;can-define/map/&quot;),
    DefineList = require(&quot;can-define/list/&quot;);

var Todo = DefineMap.extend(&quot;Todo&quot;, {
    id: &quot;string&quot;,
    name: &quot;string&quot;,
    complete: {
        type: &quot;boolean&quot;,
        value: false
    },
    toggleComplete: function() {
        this.complete = !this.complete;
    }
});

Todo.List = DefineList.extend(&quot;TodoList&quot;, {
    &quot;#&quot;: Todo,
    get active() {
        return this.filter({
            complete: false
        });
    },
    get complete() {
        return this.filter({
            complete: true
        });
    },
    get allComplete() {
        return this.length === this.complete.length;
    }
});

module.exports = Todo;

</code></pre>
<p><span line-highlight='3,17-32,only'></span></p>
<h2>Render a list of todos (can-stache)</h2>
<h3>The problem</h3>
<ul>
<li><p>Add a <code>todosList</code> property to the <code>AppViewModel</code> whose default
value will be a <code>Todo.List</code> with the following data:</p>
<pre><code class="language-js">[
  { name: &quot;mow lawn&quot;, complete: false, id: 5 },
  { name: &quot;dishes&quot;, complete: true, id: 6 },
  { name: &quot;learn canjs&quot;, complete: false, id: 7 }
]
</code></pre></li>
<li><p>Write out an <code>&lt;li&gt;</code> for each todo in <code>todosList</code>, including:</p>
<ul>
<li>write the todo's name in the  <code>&lt;label&gt;</code></li>
<li>add <code>completed</code> in the <code>&lt;li&gt;</code>'s <code>class</code> if the todo is <code>complete</code>.</li>
<li>check the todo's checkbox if the todo is <code>complete</code>.</li>
</ul></li>
<li><p>Write out the number of items left and completed count in the &quot;clear completed&quot; button.</p></li>
</ul>
<h3>What you need to know</h3>
<ul>
<li><p><a href="https://drive.google.com/open?id=0Bx-kNqf-wxZeSjVJMTRJdXRXcWs">Stache Basics Presentation</a></p></li>
<li><p>CanJS uses <a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a> to render data in a template
and keep it live. Templates can be loaded with <a href="../../steal-stache.html" title="A StealJS extension that allows stache templates as dependencies.">steal-stache</a>.</p>
<p>A <a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a> template uses
<a href="../../can-stache.tags.escaped.html" title="Insert the value of the expression into the output of the template.">{{key}}</a> magic tags to insert data into
the HTML output like:</p>
<pre><code class="language-html">  {{something.name}}
</code></pre></li>
<li><p>Use <a href="../../can-stache.helpers.if.html" title="can-stache.helpers.if">{{#if value}}</a> to do <code>if/else</code> branching in <code>can-stache</code>.</p></li>
<li><p>Use <a href="../../can-stache.helpers.each.html" title="">{{#each value}}</a> to do looping in <code>can-stache</code>.</p></li>
</ul>
<h3>The solution</h3>
<p>Update <em>index.js</em> to the following:</p>
<pre><code class="language-js">// index.js
var view = require(&quot;./index.stache&quot;);
var DefineMap = require(&quot;can-define/map/&quot;);
var Todo = require(&quot;~/models/todo&quot;);

var AppViewModel = DefineMap.extend(&quot;AppViewModel&quot;,{
    appName: &quot;string&quot;,
    todosList: {
        value: function(){
            return new Todo.List([
                { name: &quot;mow lawn&quot;, complete: false, id: 5 },
                { name: &quot;dishes&quot;, complete: true, id: 6 },
                { name: &quot;learn canjs&quot;, complete: false, id: 7 }
            ]);
        }
    }
});

var appVM = window.appVM = new AppViewModel({
    appName: &quot;TodoMVC&quot;
});

var frag = view(appVM);
document.body.appendChild(frag);

require(&quot;can-todomvc-test&quot;)(appVM);

</code></pre>
<p><span line-highlight='4,8-16,only'></span>
Update <em>index.stache</em> to the following:</p>
<pre><code class="language-html">&lt;!-- index.stache --&gt;
&lt;section id=&quot;todoapp&quot;&gt;
    &lt;header id=&quot;header&quot;&gt;
        &lt;h1&gt;{{appName}}&lt;/h1&gt;
        &lt;input id=&quot;new-todo&quot; placeholder=&quot;What needs to be done?&quot;&gt;
    &lt;/header&gt;
    &lt;section id=&quot;main&quot; class=&quot;&quot;&gt;
        &lt;input id=&quot;toggle-all&quot; type=&quot;checkbox&quot;&gt;
        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;
        &lt;ul id=&quot;todo-list&quot;&gt;
            {{#each todosList}}
            &lt;li class=&quot;todo {{#if complete}}completed{{/if}}&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;
                        {{#if complete}}checked{{/if}}/&gt;
                    &lt;label&gt;{{name}}&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;{{name}}&quot;/&gt;
            &lt;/li&gt;
            {{/each}}
        &lt;/ul&gt;
    &lt;/section&gt;
    &lt;footer id=&quot;footer&quot; class=&quot;&quot;&gt;
        &lt;span id=&quot;todo-count&quot;&gt;
            &lt;strong&gt;{{todosList.active.length}}&lt;/strong&gt; items left
        &lt;/span&gt;
        &lt;ul id=&quot;filters&quot;&gt;
            &lt;li&gt;
                &lt;a class=&quot;selected&quot; href=&quot;#!&quot;&gt;All&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!active&quot;&gt;Active&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!completed&quot;&gt;Completed&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;button id=&quot;clear-completed&quot;&gt;
            Clear completed ({{todosList.complete.length}})
        &lt;/button&gt;
    &lt;/footer&gt;
&lt;/section&gt;

</code></pre>
<p><span line-highlight='11-21,26,40,only'></span></p>
<h2>Toggle a todo's completed state (event bindings)</h2>
<h3>The problem</h3>
<ul>
<li>Call <code>toggleComplete</code> when a todo's checkbox is clicked upon.</li>
</ul>
<h3>What you need to know</h3>
<ul>
<li><p><a href="https://drive.google.com/open?id=0Bx-kNqf-wxZeNDd4aTFNU2g1U0k">The can-stache-bindings Presentation's</a> <em>DOM Event Bindings</em></p></li>
<li><p>Use <a href="../../can-stache-bindings.event.html" title="Respond to events on elements or component ViewModels.">($EVENT)</a> to listen to an event on an element and call a method in <code>can-stache</code>.  For example, the following calls <code>doSomething()</code> when the <code>&lt;div&gt;</code> is clicked.</p>
<pre><code class="language-html">&lt;div ($click)=&quot;doSomething()&quot;&gt; ... &lt;/div&gt;
</code></pre></li>
</ul>
<h3>The solution</h3>
<pre><code class="language-html">&lt;!-- index.stache --&gt;
&lt;section id=&quot;todoapp&quot;&gt;
    &lt;header id=&quot;header&quot;&gt;
        &lt;h1&gt;{{appName}}&lt;/h1&gt;
        &lt;input id=&quot;new-todo&quot; placeholder=&quot;What needs to be done?&quot;&gt;
    &lt;/header&gt;
    &lt;section id=&quot;main&quot; class=&quot;&quot;&gt;
        &lt;input id=&quot;toggle-all&quot; type=&quot;checkbox&quot;&gt;
        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;
        &lt;ul id=&quot;todo-list&quot;&gt;
            {{#each todosList}}
            &lt;li class=&quot;todo {{#if complete}}completed{{/if}}&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;
                        {{#if complete}}checked{{/if}}
                        ($click)=&quot;toggleComplete()&quot;/&gt;
                    &lt;label&gt;{{name}}&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;{{name}}&quot;/&gt;
            &lt;/li&gt;
            {{/each}}
        &lt;/ul&gt;
    &lt;/section&gt;
    &lt;footer id=&quot;footer&quot; class=&quot;&quot;&gt;
        &lt;span id=&quot;todo-count&quot;&gt;
            &lt;strong&gt;{{todosList.active.length}}&lt;/strong&gt; items left
        &lt;/span&gt;
        &lt;ul id=&quot;filters&quot;&gt;
            &lt;li&gt;
                &lt;a class=&quot;selected&quot; href=&quot;#!&quot;&gt;All&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!active&quot;&gt;Active&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!completed&quot;&gt;Completed&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;button id=&quot;clear-completed&quot;&gt;
            Clear completed ({{todosList.complete.length}})
        &lt;/button&gt;
    &lt;/footer&gt;
&lt;/section&gt;

</code></pre>
<p><span line-highlight='14-16,only'></span></p>
<h2>Toggle a todo's completed state (data bindings)</h2>
<h3>The problem</h3>
<ul>
<li>Update a todo's <code>complete</code> property when the checkbox's <code>checked</code> property changes with <a href="../../can-stache-bindings.twoWay.html" title="Two-way bind a value in the viewModel or the element to the parent scope.">two-way bindings</a>.</li>
</ul>
<h3>What you need to know</h3>
<ul>
<li><p><a href="https://drive.google.com/open?id=0Bx-kNqf-wxZeNDd4aTFNU2g1U0k">The can-stache-bindings Presentation's</a> <em>DOM Data Bindings</em></p></li>
<li><p>Use <a href="../../can-stache-bindings.twoWay.html" title="Two-way bind a value in the viewModel or the element to the parent scope.">{($value)}</a> to setup a two-way binding in <code>can-stache</code>.  For example, the following keeps <code>name</code> and the input's <code>value</code> in sync:</p>
<pre><code class="language-html">&lt;input  {($value)}=&quot;name&quot;/&gt;
</code></pre></li>
</ul>
<h3>The solution</h3>
<pre><code class="language-html">&lt;!-- index.stache --&gt;
&lt;section id=&quot;todoapp&quot;&gt;
    &lt;header id=&quot;header&quot;&gt;
        &lt;h1&gt;{{appName}}&lt;/h1&gt;
        &lt;input id=&quot;new-todo&quot; placeholder=&quot;What needs to be done?&quot;&gt;
    &lt;/header&gt;
    &lt;section id=&quot;main&quot; class=&quot;&quot;&gt;
        &lt;input id=&quot;toggle-all&quot; type=&quot;checkbox&quot;&gt;
        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;
        &lt;ul id=&quot;todo-list&quot;&gt;
            {{#each todosList}}
            &lt;li class=&quot;todo {{#if complete}}completed{{/if}}&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;
                        {($checked)}=&quot;complete&quot;/&gt;
                    &lt;label&gt;{{name}}&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;{{name}}&quot;/&gt;
            &lt;/li&gt;
            {{/each}}
        &lt;/ul&gt;
    &lt;/section&gt;
    &lt;footer id=&quot;footer&quot; class=&quot;&quot;&gt;
        &lt;span id=&quot;todo-count&quot;&gt;
            &lt;strong&gt;{{todosList.active.length}}&lt;/strong&gt; items left
        &lt;/span&gt;
        &lt;ul id=&quot;filters&quot;&gt;
            &lt;li&gt;
                &lt;a class=&quot;selected&quot; href=&quot;#!&quot;&gt;All&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!active&quot;&gt;Active&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!completed&quot;&gt;Completed&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;button id=&quot;clear-completed&quot;&gt;
            Clear completed ({{todosList.complete.length}})
        &lt;/button&gt;
    &lt;/footer&gt;
&lt;/section&gt;

</code></pre>
<p><span line-highlight='14-15,only'></span></p>
<h2>Define Todo.algebra (can-set)</h2>
<h3>The problem</h3>
<ul>
<li><p>Create a <code>set.Algebra</code> that understand the parameters of the <code>/api/todos</code> service layer.  The <code>/api/todos</code> service
layer will support the following parameters:</p>
<ul>
<li><code>complete</code> - Specifies a filter on todos' <code>complete</code> field.  Examples: <code>complete=true</code>, <code>complete=false</code>.</li>
<li><code>sort</code> - Specifies the sorted order the todos should be returned.  Examples: <code>sort=name</code>.</li>
<li><code>id</code> - Specifies the <code>id</code> property to use in <code>/api/todos/{id}</code></li>
</ul>
<p>Example:</p>
<pre><code>GET /api/todos?complete=true&amp;sort=name
</code></pre></li>
</ul>
<p>Example test code:</p>
<pre><code class="language-js">QUnit.deepEqual( Todo.algebra.difference({}, {complete: true}), {complete: false} );
QUnit.deepEqual( Todo.algebra.clauses.id, {id: &quot;id&quot;} );

var sorted = Todo.algebra.getSubset({sort: &quot;name&quot;}, {}, [
    { name: &quot;mow lawn&quot;, complete: false, id: 5 },
    { name: &quot;dishes&quot;, complete: true, id: 6 },
    { name: &quot;learn canjs&quot;, complete: false, id: 7 }
]);
QUnit.deepEqual(sorted, [
    { name: &quot;dishes&quot;, complete: true, id: 6 },
    { name: &quot;learn canjs&quot;, complete: false, id: 7 },
    { name: &quot;mow lawn&quot;, complete: false, id: 5 }
]);
</code></pre>
<h3>What you need to know</h3>
<ul>
<li><p><a href="https://drive.google.com/open?id=0Bx-kNqf-wxZeV2lVNl9XanhHZ0k">The can-set Presentation</a></p></li>
<li><p><a href="../../can-set.html" title="can-set is a utility for comparing sets that are represented by the parameters commonly passed to service requests.">can-set</a> provides a way to describe the parameters used in the service layer.  You use it to create
a <a href="../../can-set.Algebra.html" title="Perform set logic with an awareness of how certain properties represent a set.">Algebra</a> like:</p>
<pre><code class="language-js">var todoAlgebra = new set.Algebra(
  set.props.boolean(&quot;completed&quot;),
  set.props.id(&quot;_id&quot;),
  set.props.offsetLimit(&quot;offset&quot;,&quot;limit&quot;)
);
</code></pre>
<p>The algebra can then be used to perform comparisons between parameters like:</p>
<pre><code class="language-js">todoAlgebra.difference({}, {completed: true}) //-&gt; {completed: false}
</code></pre></li>
<li><p>Use <a href="../../can-set.props.html" title="Contains a collection of prop generating functions.
The following functions create compares objects that can be mixed together to create a set Algebra.
var set = require(&quot;can-set&quot;);
var algebra = new set.Algebra(
  {
    // ignore this property in set algebra
    sessionId:  function(){ return true }
  },
  set.props.boolean(&quot;completed&quot;),
  set.props.rangeInclusive(&quot;start&quot;,&quot;end&quot;)
);">set.props</a> to describe the behavior of your set parameters.</p></li>
</ul>
<h3>The solution</h3>
<pre><code>npm install can-set --save
</code></pre>
<pre><code class="language-js">// models/todo.js
var DefineMap = require(&quot;can-define/map/&quot;),
    DefineList = require(&quot;can-define/list/&quot;),
    set = require(&quot;can-set&quot;);

var Todo = DefineMap.extend(&quot;Todo&quot;, {
    id: &quot;string&quot;,
    name: &quot;string&quot;,
    complete: {
        type: &quot;boolean&quot;,
        value: false
    },
    toggleComplete: function() {
        this.complete = !this.complete;
    }
});

Todo.List = DefineList.extend(&quot;TodoList&quot;, {
    &quot;#&quot;: Todo,
    get active() {
        return this.filter({
            complete: false
        });
    },
    get complete() {
        return this.filter({
            complete: true
        });
    },
    get allComplete() {
        return this.length === this.complete.length;
    }
});

Todo.algebra = new set.Algebra(
    set.props.boolean(&quot;complete&quot;),
    set.props.id(&quot;id&quot;),
    set.props.sort(&quot;sort&quot;)
);

module.exports = Todo;

</code></pre>
<p><span line-highlight='4,35-39,only'></span></p>
<h2>Simulate the service layer (can-fixture)</h2>
<h3>The problem</h3>
<p>Simulate a service layer that handles the following requests and responses:</p>
<p><strong>GET /api/todos</strong></p>
<pre><code>-&gt; GET /api/todos

&lt;- {
    &quot;data&quot;: [
      { &quot;name&quot;: &quot;mow lawn&quot;, &quot;complete&quot;: false, &quot;id&quot;: 5 },
      { &quot;name&quot;: &quot;dishes&quot;, &quot;complete&quot;: true, &quot;id&quot;: 6 },
      { &quot;name&quot;: &quot;learn canjs&quot;, &quot;complete&quot;: false, &quot;id&quot;: 7 }
    ]
}
</code></pre>
<p>This should also support a <code>sort</code> and <code>complete</code> params like:</p>
<pre><code>-&gt; GET /api/todos?sort=name&amp;complete=true
</code></pre>
<p><strong>GET /api/todos/{id}</strong></p>
<pre><code>-&gt; GET /api/todos/5

&lt;- { &quot;name&quot;: &quot;mow lawn&quot;, &quot;complete&quot;: false, &quot;id&quot;: 5 }
</code></pre>
<p><strong>POST /api/todos</strong></p>
<pre><code>-&gt; POST /api/todos
   {&quot;name&quot;: &quot;learn can-fixture&quot;, &quot;complete&quot;: false}

&lt;- {&quot;id&quot;: 8}
</code></pre>
<p><strong>PUT /api/todos/{id}</strong></p>
<pre><code>-&gt; PUT /api/todos/8
   {&quot;name&quot;: &quot;learn can-fixture&quot;, &quot;complete&quot;: true}

&lt;- {&quot;id&quot;: 8, &quot;name&quot;: &quot;learn can-fixture&quot;, &quot;complete&quot;: true}
</code></pre>
<p><strong>DELETE /api/todos/{id}</strong></p>
<pre><code>-&gt; DELETE /api/todos/8

&lt;- {}
</code></pre>
<h3>What you need to know</h3>
<ul>
<li><p><a href="https://drive.google.com/open?id=0Bx-kNqf-wxZeekROYmxvTnUtWmM">The can-fixture Presentation</a></p></li>
<li><p><a href="../../can-fixture.html" title="can-fixture intercepts an AJAX request and simulates the response with a file or function.">can-fixture</a> - is used to trap AJAX requests like:</p>
<pre><code class="language-js">fixture(&quot;/api/entities&quot;, function(request){
  request.data.folderId //-&gt; &quot;1&quot;

  return {data: [...]}
})
</code></pre></li>
<li><p><a href="../../can-fixture.store.html" title="">can-fixture.store</a> - can be used to automatically filter records if given a <a href="../../can-set.Algebra.html" title="Perform set logic with an awareness of how certain properties represent a set.">Algebra</a>.</p>
<pre><code class="language-js">var entities = [ .... ];
var entitiesStore = fixture.store( entities, entitiesAlgebra );
fixture(&quot;/api/entities/{id}&quot;, entitiesStore);

</code></pre></li>
</ul>
<h3>The solution</h3>
<pre><code>npm install can-fixture --save
</code></pre>
<p>Create <em>models/todos-fixture.js</em> as follows:</p>
<pre><code class="language-js">// models/todos-fixture.js
var fixture = require(&quot;can-fixture&quot;);
var Todo = require(&quot;./todo&quot;);

var todoStore = fixture.store([
    { name: &quot;mow lawn&quot;, complete: false, id: 5 },
    { name: &quot;dishes&quot;, complete: true, id: 6 },
    { name: &quot;learn canjs&quot;, complete: false, id: 7 }
], Todo.algebra);

fixture(&quot;/api/todos&quot;, todoStore);
fixture.delay = 500;

module.exports = todoStore;

</code></pre>
<h2>Connect the Todo model to the service layer (can-connect)</h2>
<h3>The problem</h3>
<ul>
<li>Decorate <code>Todo</code> with methods so it can get, create, updated, and delete todos at the <code>/api/todos</code> service.  Specifically:
<ul>
<li><code>Todo.getList()</code> which calls <code>GET /api/todos</code></li>
<li><code>Todo.getList({id: 5})</code> which calls <code>GET /api/todos/5</code></li>
<li><code>todo.save()</code> which calls <code>POST /api/todos</code> if <code>todo</code> doesn't have an <code>id</code> or <code>PUT /api/todos/{id}</code> if the <code>todo</code> has an id.</li>
<li><code>todo.destroy()</code> which calls <code>DELETE /api/todos/5</code></li>
</ul></li>
</ul>
<h3>What you need to know</h3>
<ul>
<li><p><a href="https://drive.google.com/open?id=0Bx-kNqf-wxZebHFWMElNOVEwSlE">The can-connect Presentation</a> up to and including <em>Migrate 2 can-connect</em>.</p></li>
<li><p><a href="../../can-connect/can/base-map/base-map.html" title="Create connection with many of the best behaviors in can-connect and hook it up to
a map.">can-connect/can/base-map/base-map</a> can decorate a <code>DefineMap</code> with methods that connect it to a restful URL like:</p>
<pre><code class="language-js">baseMap({
  Map: Type,
  url: &quot;URL&quot;,
  algebra: algebra
})
</code></pre></li>
</ul>
<h3>The solution</h3>
<pre><code>npm install can-connect --save
</code></pre>
<pre><code class="language-js">// models/todo.js
var DefineMap = require(&quot;can-define/map/&quot;),
    DefineList = require(&quot;can-define/list/&quot;),
    set = require(&quot;can-set&quot;),
    connectBaseMap = require(&quot;can-connect/can/base-map/&quot;);

var Todo = DefineMap.extend(&quot;Todo&quot;, {
    id: &quot;string&quot;,
    name: &quot;string&quot;,
    complete: {
        type: &quot;boolean&quot;,
        value: false
    },
    toggleComplete: function() {
        this.complete = !this.complete;
    }
});

Todo.List = DefineList.extend(&quot;TodoList&quot;, {
    &quot;#&quot;: Todo,
    get active() {
        return this.filter({
            complete: false
        });
    },
    get complete() {
        return this.filter({
            complete: true
        });
    },
    get allComplete() {
        return this.length === this.complete.length;
    }
});

Todo.algebra = new set.Algebra(
    set.props.boolean(&quot;complete&quot;),
    set.props.id(&quot;id&quot;),
    set.props.sort(&quot;sort&quot;)
);

Todo.connection = connectBaseMap({
    url: &quot;/api/todos&quot;,
    Map: Todo,
    List: Todo.List,
    name: &quot;todo&quot;,
    algebra: Todo.algebra
});

module.exports = Todo;

</code></pre>
<p><span line-highlight='5,42-48,only'></span></p>
<h2>List todos from the service layer (can-connect use)</h2>
<h3>The problem</h3>
<p>Get all <code>todos</code> from the service layer using the &quot;connected&quot; <code>Todo</code> type.</p>
<h3>What you need to know</h3>
<ul>
<li><p><a href="https://drive.google.com/open?id=0Bx-kNqf-wxZebHFWMElNOVEwSlE">The can-connect Presentation</a> up to and including <em>Important Interfaces</em>.</p></li>
<li><p><a href="../../can-connect/can/map/map.getList.html" title="Gets a list of instances of the map type.">Type.getList</a> gets data using the
<a href="../../can-connect/connection.getList.html" title="Gets a can-connect.List of instances.">connection's getList</a> and returns a
promise that resolves to the <code>Type.List</code> of instances:</p>
<pre><code class="language-js">Type.getList({}).then(function(list){

})
</code></pre></li>
<li><p>An async <a href="../../can-define.types.get.html" title="Specify what happens when a certain property is read on a map. get functions
work like a can-compute and automatically update themselves when a dependent
observable value is changed.">getter</a> property behavior can be used
to &quot;set&quot; a property to an initial value:</p>
<pre><code class="language-js">property: {
    get: function(lastSet, resolve){
        SOME_ASYNC_METHOD( function callback(data) {
            resolve(data);
        });
    }
}
</code></pre></li>
</ul>
<h3>The solution</h3>
<pre><code class="language-js">// index.js
var view = require(&quot;./index.stache&quot;);
var DefineMap = require(&quot;can-define/map/&quot;);
var Todo = require(&quot;~/models/todo&quot;);
require(&quot;~/models/todos-fixture&quot;);

var AppViewModel = DefineMap.extend(&quot;AppViewModel&quot;,{
    appName: &quot;string&quot;,
    todosList: {
        get: function(lastSet, resolve){
            Todo.getList({}).then(resolve);
        }
    }
});

var appVM = window.appVM = new AppViewModel({
    appName: &quot;TodoMVC&quot;
});

var frag = view(appVM);
document.body.appendChild(frag);

require(&quot;can-todomvc-test&quot;)(appVM);

</code></pre>
<p><span line-highlight='4-5,9-13,only'></span></p>
<h2>Toggling a todo's checkbox updates service layer (can-connect use)</h2>
<h3>The problem</h3>
<p>Update the service layer when a todo's completed status
changes. Also, disable the checkbox while the update is happening.</p>
<h3>What you need to know</h3>
<ul>
<li><p>Call <a href="../../can-connect/can/map/map.prototype.save.html" title="Persists the map's data to the connection.">save</a> to update a &quot;connected&quot;
<code>Map</code> instance:</p>
<pre><code>map.save();
</code></pre>
<p><code>save()</code> can also be called by an <a href="../../can-stache-bindings.event.html" title="Respond to events on elements or component ViewModels.">(event)</a> binding.</p></li>
<li><p><a href="../../can-connect/can/map/map.prototype.isSaving.html" title="Returns if the map is currently being saved.">isSaving</a> returns true when <code>.save()</code>
has been called, but has not resolved yet.</p>
<pre><code>map.isSaving()
</code></pre></li>
</ul>
<h3>The solution</h3>
<pre><code class="language-html">&lt;!-- index.stache --&gt;
&lt;section id=&quot;todoapp&quot;&gt;
    &lt;header id=&quot;header&quot;&gt;
        &lt;h1&gt;{{appName}}&lt;/h1&gt;
        &lt;input id=&quot;new-todo&quot; placeholder=&quot;What needs to be done?&quot;&gt;
    &lt;/header&gt;
    &lt;section id=&quot;main&quot; class=&quot;&quot;&gt;
        &lt;input id=&quot;toggle-all&quot; type=&quot;checkbox&quot;&gt;
        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;
        &lt;ul id=&quot;todo-list&quot;&gt;
            {{#each todosList}}
            &lt;li class=&quot;todo {{#if complete}}completed{{/if}}&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;
                        {($checked)}=&quot;complete&quot;
                        ($change)=&quot;save()&quot;
                        {$disabled}=&quot;isSaving()&quot;/&gt;
                    &lt;label&gt;{{name}}&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;{{name}}&quot;/&gt;
            &lt;/li&gt;
            {{/each}}
        &lt;/ul&gt;
    &lt;/section&gt;
    &lt;footer id=&quot;footer&quot; class=&quot;&quot;&gt;
        &lt;span id=&quot;todo-count&quot;&gt;
            &lt;strong&gt;{{todosList.active.length}}&lt;/strong&gt; items left
        &lt;/span&gt;
        &lt;ul id=&quot;filters&quot;&gt;
            &lt;li&gt;
                &lt;a class=&quot;selected&quot; href=&quot;#!&quot;&gt;All&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!active&quot;&gt;Active&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!completed&quot;&gt;Completed&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;button id=&quot;clear-completed&quot;&gt;
            Clear completed ({{todosList.complete.length}})
        &lt;/button&gt;
    &lt;/footer&gt;
&lt;/section&gt;

</code></pre>
<p><span line-highlight='16-17,only'></span></p>
<h2>Delete todos in the page (can-connect use)</h2>
<h3>The problem</h3>
<p>When a todo's <strong>destroy</strong> button is clicked, we need to delete the
todo on the server and remove the todo's element from the page. While
the todo is being destroyed, add <code>destroying</code> to the todo's <code>&lt;li&gt;</code>'s <code>class</code>
attribute.</p>
<h3>Things to know</h3>
<ul>
<li><p>The remaining parts of the <a href="https://drive.google.com/open?id=0Bx-kNqf-wxZebHFWMElNOVEwSlE">can-connect Presentation</a>, with an emphasis on how <a href="../../can-connect/real-time/real-time.html" title="Update lists to include or exclude instances based
on set logic.">can-connect/real-time/real-time</a> behavior works.</p></li>
<li><p>Delete a record on the server with <a href="../../can-connect/can/map/map.prototype.destroy.html" title="Delete's the instance with the connection.">destroy</a> like:</p>
<pre><code class="language-js">map.destroy()
</code></pre></li>
<li><p><a href="../../can-connect/can/map/map.prototype.isDestroying.html" title="Returns if the map is currently being destroyed.">isDestroying</a> returns true when <code>.destroy()</code>
has been called, but has not resolved yet.</p>
<pre><code class="language-js">map.isDestroying()
</code></pre></li>
</ul>
<h3>The solution</h3>
<pre><code class="language-html">&lt;!-- index.stache --&gt;
&lt;section id=&quot;todoapp&quot;&gt;
    &lt;header id=&quot;header&quot;&gt;
        &lt;h1&gt;{{appName}}&lt;/h1&gt;
        &lt;input id=&quot;new-todo&quot; placeholder=&quot;What needs to be done?&quot;&gt;
    &lt;/header&gt;
    &lt;section id=&quot;main&quot; class=&quot;&quot;&gt;
        &lt;input id=&quot;toggle-all&quot; type=&quot;checkbox&quot;&gt;
        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;
        &lt;ul id=&quot;todo-list&quot;&gt;
            {{#each todosList}}
            &lt;li class=&quot;todo {{#if complete}}completed{{/if}}
                {{#if isDestroying}}destroying{{/if}}&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;
                        {($checked)}=&quot;complete&quot;
                        ($change)=&quot;save()&quot;
                        {$disabled}=&quot;isSaving()&quot;/&gt;
                    &lt;label&gt;{{name}}&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot; ($click)=&quot;destroy()&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;{{name}}&quot;/&gt;
            &lt;/li&gt;
            {{/each}}
        &lt;/ul&gt;
    &lt;/section&gt;
    &lt;footer id=&quot;footer&quot; class=&quot;&quot;&gt;
        &lt;span id=&quot;todo-count&quot;&gt;
            &lt;strong&gt;{{todosList.active.length}}&lt;/strong&gt; items left
        &lt;/span&gt;
        &lt;ul id=&quot;filters&quot;&gt;
            &lt;li&gt;
                &lt;a class=&quot;selected&quot; href=&quot;#!&quot;&gt;All&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!active&quot;&gt;Active&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!completed&quot;&gt;Completed&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;button id=&quot;clear-completed&quot;&gt;
            Clear completed ({{todosList.complete.length}})
        &lt;/button&gt;
    &lt;/footer&gt;
&lt;/section&gt;

</code></pre>
<p><span line-highlight='13,20,only'></span></p>
<h2>Create todos (can-component)</h2>
<h3>The problem</h3>
<p>Make it possible to create a todo, update the service layer
and show the todo in the list of todos.</p>
<p>This functionality should be encapsulated by a <code>&lt;todo-create/&gt;</code>
custom element.</p>
<h3>What you need to know</h3>
<ul>
<li><p><a href="https://drive.google.com/open?id=0Bx-kNqf-wxZeMnlHZzB6ZERUSEk">The  can-component presentation</a> up to and including how to <em>define a component</em>.</p></li>
<li><p>A <a href="../../can-component.html" title="Create a custom element that can be used to manage widgets or application logic.">can-component</a> combines a custom tag name, <a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a> view and a <a href="../../can-define/map/map.html" title="Create observable objects.">can-define/map/map</a> ViewModel like:</p>
<pre><code class="language-js">var Component = require(&quot;can-component&quot;);
var view = require(&quot;./template.stache&quot;);
var ViewModel = DefineMap.extend({
  ...      
});

Component.extend({
    tag: &quot;some-component&quot;,
    view: view,
    ViewModel: ViewModel
});
</code></pre></li>
<li><p>You can use <code>($enter)</code> to listen to when the user hits the <strong>enter</strong> key.</p></li>
<li><p>The <a href="../../can-define.types.ValueConstructor.html" title="Provides a constructor function to be used to provide a default value for a property.">Value</a> behavior creates a default value by using <code>new Value</code> to initialize the value when
a <code>DefineMap</code> property is read for the first time.</p>
<pre><code class="language-js">var SubType = DefineMap.extend({})
var Type = DefineMap.extend({
    property: {Value: SubType}
})

var map = new Type();
map.property instanceof SubType //-&gt; true
</code></pre></li>
<li><p>Use <a href="../../can-view-import.html" title="">can-view-import</a> to import a module from a template like:</p>
<pre><code>&lt;can-import from=&quot;~/components/some-component/&quot;/&gt;
&lt;some-component&gt;
</code></pre></li>
</ul>
<h3>The solution</h3>
<pre><code>npm install can-component --save
</code></pre>
<p>Create <em>components/todo-create/todo-create.stache</em> as follows:</p>
<pre><code class="language-html">&lt;!-- components/todo-create/todo-create.stache --&gt;
&lt;input id=&quot;new-todo&quot;
    placeholder=&quot;What needs to be done?&quot;
    {($value)}=&quot;todo.name&quot;
    ($enter)=&quot;createTodo()&quot;/&gt;

</code></pre>
<p>Create <em>components/todo-create/todo-create.js</em> as follows:</p>
<pre><code class="language-js">// components/todo-create/todo-create.js
var Component = require(&quot;can-component&quot;); // remember to install
var DefineMap = require(&quot;can-define/map/&quot;);
var view = require(&quot;./todo-create.stache&quot;);
var Todo = require(&quot;~/models/todo&quot;);

var TodoCreateVM = DefineMap.extend({
    todo: {
        Value: Todo
    },
    createTodo: function() {
        this.todo.save().then(function() {
            this.todo = new Todo();
        }.bind(this));
    }
});

module.exports = Component.extend({
    tag: &quot;todo-create&quot;,
    view: view,
    ViewModel: TodoCreateVM
});

</code></pre>
<p>Update <em>index.stache</em> to:</p>
<pre><code class="language-html">&lt;!-- index.stache --&gt;
&lt;can-import from=&quot;~/components/todo-create/&quot;/&gt;
&lt;section id=&quot;todoapp&quot;&gt;
    &lt;header id=&quot;header&quot;&gt;
        &lt;h1&gt;{{appName}}&lt;/h1&gt;
        &lt;todo-create/&gt;
    &lt;/header&gt;
    &lt;section id=&quot;main&quot; class=&quot;&quot;&gt;
        &lt;input id=&quot;toggle-all&quot; type=&quot;checkbox&quot;&gt;
        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;
        &lt;ul id=&quot;todo-list&quot;&gt;
            {{#each todosList}}
            &lt;li class=&quot;todo {{#if complete}}completed{{/if}}
                {{#if isDestroying}}destroying{{/if}}&quot;&gt;
                &lt;div class=&quot;view&quot;&gt;
                    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;
                        {($checked)}=&quot;complete&quot;
                        ($change)=&quot;save()&quot;
                        {$disabled}=&quot;isSaving()&quot;/&gt;
                    &lt;label&gt;{{name}}&lt;/label&gt;
                    &lt;button class=&quot;destroy&quot; ($click)=&quot;destroy()&quot;&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;input class=&quot;edit&quot; type=&quot;text&quot; value=&quot;{{name}}&quot;/&gt;
            &lt;/li&gt;
            {{/each}}
        &lt;/ul&gt;
    &lt;/section&gt;
    &lt;footer id=&quot;footer&quot; class=&quot;&quot;&gt;
        &lt;span id=&quot;todo-count&quot;&gt;
            &lt;strong&gt;{{todosList.active.length}}&lt;/strong&gt; items left
        &lt;/span&gt;
        &lt;ul id=&quot;filters&quot;&gt;
            &lt;li&gt;
                &lt;a class=&quot;selected&quot; href=&quot;#!&quot;&gt;All&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!active&quot;&gt;Active&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!completed&quot;&gt;Completed&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;button id=&quot;clear-completed&quot;&gt;
            Clear completed ({{todosList.complete.length}})
        &lt;/button&gt;
    &lt;/footer&gt;
&lt;/section&gt;

</code></pre>
<p><span line-highlight='2,6,only'></span></p>
<h2>Edit todo names (can-stache-bindings)</h2>
<h3>The problem</h3>
<p>Make it possible to edit a <code>todos</code> name by
double-clicking it's label which should reveal
a <em>focused</em> input element.  If the user hits
the <strong>enter</strong> key, the todo should be updated on the
server.  If the input loses focus, it should go
back to the default list view.</p>
<p>This functionality should be encapsulated by a <code>&lt;todo-list {todos}/&gt;</code>
custom element.  It should accept a <code>todos</code> property that
is the list of todos that will be managed by the custom element.</p>
<h3>What you need to know</h3>
<ul>
<li><p><a href="https://drive.google.com/open?id=0Bx-kNqf-wxZeNDd4aTFNU2g1U0k">The can-stache-bindings presentation</a> on <em>data bindings</em>.</p></li>
<li><p>The <a href="../../can-util/dom/attr/attr.special.focused.html" title="Signifies if an element, usually an &lt;input&gt; is the focused element on the page.">focused</a> custom attribute can be used to specify when an element should be focused:</p>
<pre><code class="language-html">{$focused}=&quot;shouldBeFocused()&quot;
</code></pre></li>
<li><p>Use <a href="../../can-stache-bindings.toChild.html" title="One-way bind a value in the parent scope to the ViewModel.">{to-child}</a> to pass a value from the scope to a component:</p>
<pre><code>&lt;some-component {name-in-component}=&quot;nameInScope&quot;/&gt;
</code></pre></li>
<li><p><a href="../../can-stache/keys/this.html" title="Write out or return the current context.">this</a> can be used to get the current context in stache:</p>
<pre><code>&lt;div ($click)=&quot;doSomethingWith(this)&quot;/&gt;
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Create <em>components/todo-list/todo-list.stache</em> as follows:</p>
<pre><code class="language-html">&lt;!-- components/todo-list/todo-list.stache --&gt;
&lt;ul id=&quot;todo-list&quot;&gt;
    {{#each todos}}
    &lt;li class=&quot;todo {{#if ./complete}}completed{{/if}}
        {{#if isDestroying}}destroying{{/if}}
        {{#if isEditing(this)}}editing{{/if}}&quot;&gt;
        &lt;div class=&quot;view&quot;&gt;
            &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot;
                {($checked)}=&quot;complete&quot;
                ($change)=&quot;save()&quot;
                {$disabled}=&quot;isSaving()&quot;/&gt;
            &lt;label ($dblclick)=&quot;edit(this)&quot;&gt;{{name}}&lt;/label&gt;
            &lt;button class=&quot;destroy&quot; ($click)=&quot;destroy()&quot;&gt;&lt;/button&gt;
        &lt;/div&gt;
        &lt;input class=&quot;edit&quot; type=&quot;text&quot;
            {($value)}=&quot;name&quot;
            ($enter)=&quot;updateName()&quot;
            {$focused}=&quot;isEditing(this)&quot;
            ($blur)=&quot;cancelEdit()&quot;/&gt;
    &lt;/li&gt;
    {{/each}}
&lt;/ul&gt;

</code></pre>
<p>Create <em>components/todo-list/todo-list.js</em> as follows:</p>
<pre><code class="language-js">// components/todo-list/todo-list.js
var Component = require(&quot;can-component&quot;);
var DefineMap = require(&quot;can-define/map/&quot;);
var view = require(&quot;./todo-list.stache&quot;);
var Todo = require(&quot;~/models/todo&quot;);

var TodoListVM = DefineMap.extend({
    todos: Todo.List,
    editing: Todo,
    backupName: &quot;string&quot;,
    isEditing: function(todo) {
        return todo === this.editing;
    },
    edit: function(todo) {
        this.backupName = todo.name;
        this.editing = todo;
    },
    cancelEdit: function() {
        if (this.editing) {
            this.editing.name = this.backupName;
        }
        this.editing = null;
    },
    updateName: function() {
        this.editing.save();
        this.editing = null;
    }
});

module.exports = Component.extend({
    tag: &quot;todo-list&quot;,
    view: view,
    ViewModel: TodoListVM
});

</code></pre>
<p>Update <em>index.stache</em> to:</p>
<pre><code class="language-html">&lt;!-- index.stache --&gt;
&lt;can-import from=&quot;~/components/todo-create/&quot;/&gt;
&lt;can-import from=&quot;~/components/todo-list/&quot;/&gt;
&lt;section id=&quot;todoapp&quot;&gt;
    &lt;header id=&quot;header&quot;&gt;
        &lt;h1&gt;{{appName}}&lt;/h1&gt;
        &lt;todo-create/&gt;
    &lt;/header&gt;
    &lt;section id=&quot;main&quot; class=&quot;&quot;&gt;
        &lt;input id=&quot;toggle-all&quot; type=&quot;checkbox&quot;&gt;
        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;
        &lt;todo-list {todos}=&quot;todosList&quot;/&gt;
    &lt;/section&gt;
    &lt;footer id=&quot;footer&quot; class=&quot;&quot;&gt;
        &lt;span id=&quot;todo-count&quot;&gt;
            &lt;strong&gt;{{todosList.active.length}}&lt;/strong&gt; items left
        &lt;/span&gt;
        &lt;ul id=&quot;filters&quot;&gt;
            &lt;li&gt;
                &lt;a class=&quot;selected&quot; href=&quot;#!&quot;&gt;All&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!active&quot;&gt;Active&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!completed&quot;&gt;Completed&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;button id=&quot;clear-completed&quot;&gt;
            Clear completed ({{todosList.complete.length}})
        &lt;/button&gt;
    &lt;/footer&gt;
&lt;/section&gt;

</code></pre>
<p><span line-highlight='3,12,only'></span></p>
<h2>Toggle all todos complete state (DefineMap setter)</h2>
<h3>The problem</h3>
<p>Make the &quot;toggle all&quot; checkbox work.  It should be
unchecked if a single todo is unchecked and checked
if all todos are checked.</p>
<p>When the &quot;toggle all&quot; checkbox is changed, the
application should update every todo to match
the status of the &quot;toggle all&quot; checkbox.</p>
<p>The &quot;toggle all&quot; checkbox should be disabled if a
single todo is saving.</p>
<h3>What you need to know</h3>
<ul>
<li><p>Using <a href="../../can-define.types.set.html" title="Specify what happens when a property value is set.">setters</a> and <a href="../../can-define.types.get.html" title="Specify what happens when a certain property is read on a map. get functions
work like a can-compute and automatically update themselves when a dependent
observable value is changed.">getters</a> a virtual property
can be simulated like:</p>
<pre><code class="language-js">DefineMap.extend({
    first: &quot;string&quot;,
    last: &quot;string&quot;,
    get fullName(){
        return this.first + &quot; &quot; + this.last;
    },
    set fullName(newValue){
        var parts = newValue.split(&quot; &quot;);
        this.first = parts[0];
        this.last = parts[1];
    }
})
</code></pre></li>
</ul>
<h3>The solution</h3>
<pre><code class="language-js">// models/todo.js
var DefineMap = require(&quot;can-define/map/&quot;),
    DefineList = require(&quot;can-define/list/&quot;),
    set = require(&quot;can-set&quot;),
    connectBaseMap = require(&quot;can-connect/can/base-map/&quot;);

var Todo = DefineMap.extend(&quot;Todo&quot;, {
    id: &quot;string&quot;,
    name: &quot;string&quot;,
    complete: {
        type: &quot;boolean&quot;,
        value: false
    },
    toggleComplete: function() {
        this.complete = !this.complete;
    }
});

Todo.List = DefineList.extend(&quot;TodoList&quot;, {
    &quot;#&quot;: Todo,
    get active() {
        return this.filter({
            complete: false
        });
    },
    get complete() {
        return this.filter({
            complete: true
        });
    },
    get allComplete() {
        return this.length === this.complete.length;
    },
    get saving() {
        return this.filter(function(todo) {
            return todo.isSaving();
        });
    },
    updateCompleteTo: function(value) {
        this.forEach(function(todo) {
            todo.complete = value;
            todo.save();
        });
    }
});

Todo.algebra = new set.Algebra(
    set.props.boolean(&quot;complete&quot;),
    set.props.id(&quot;id&quot;),
    set.props.sort(&quot;sort&quot;)
);

Todo.connection = connectBaseMap({
    url: &quot;/api/todos&quot;,
    Map: Todo,
    List: Todo.List,
    name: &quot;todo&quot;,
    algebra: Todo.algebra
});

module.exports = Todo;

</code></pre>
<p><span line-highlight='34-44,only'></span></p>
<pre><code class="language-js">// index.js
var view = require(&quot;./index.stache&quot;);
var DefineMap = require(&quot;can-define/map/&quot;);
var Todo = require(&quot;~/models/todo&quot;);
require(&quot;~/models/todos-fixture&quot;);

var AppViewModel = DefineMap.extend(&quot;AppViewModel&quot;,{
    appName: &quot;string&quot;,
    todosList: {
        get: function(lastSet, resolve){
            Todo.getList({}).then(resolve);
        }
    },
    get allChecked() {
        return this.todosList &amp;&amp; this.todosList.allComplete;
    },
    set allChecked(newVal) {
        this.todosList &amp;&amp; this.todosList.updateCompleteTo(newVal);
    }
});

var appVM = window.appVM = new AppViewModel({
    appName: &quot;TodoMVC&quot;
});

var frag = view(appVM);
document.body.appendChild(frag);

require(&quot;can-todomvc-test&quot;)(appVM);

</code></pre>
<p><span line-highlight='14-19,only'></span></p>
<pre><code class="language-html">&lt;!-- index.stache --&gt;
&lt;can-import from=&quot;~/components/todo-create/&quot;/&gt;
&lt;can-import from=&quot;~/components/todo-list/&quot;/&gt;
&lt;section id=&quot;todoapp&quot;&gt;
    &lt;header id=&quot;header&quot;&gt;
        &lt;h1&gt;{{appName}}&lt;/h1&gt;
        &lt;todo-create/&gt;
    &lt;/header&gt;
    &lt;section id=&quot;main&quot; class=&quot;&quot;&gt;
        &lt;input id=&quot;toggle-all&quot; type=&quot;checkbox&quot;
            {($checked)}=&quot;allChecked&quot;
            {$disabled}=&quot;todosList.saving.length&quot;/&gt;
        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;
        &lt;todo-list {todos}=&quot;todosList&quot;/&gt;
    &lt;/section&gt;
    &lt;footer id=&quot;footer&quot; class=&quot;&quot;&gt;
        &lt;span id=&quot;todo-count&quot;&gt;
            &lt;strong&gt;{{todosList.active.length}}&lt;/strong&gt; items left
        &lt;/span&gt;
        &lt;ul id=&quot;filters&quot;&gt;
            &lt;li&gt;
                &lt;a class=&quot;selected&quot; href=&quot;#!&quot;&gt;All&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!active&quot;&gt;Active&lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;#!completed&quot;&gt;Completed&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;button id=&quot;clear-completed&quot;&gt;
            Clear completed ({{todosList.complete.length}})
        &lt;/button&gt;
    &lt;/footer&gt;
&lt;/section&gt;

</code></pre>
<p><span line-highlight='10-12,only'></span></p>
<h2>Setup routing (can-route)</h2>
<p>Make it so that the following urls display the corresponding
todos:</p>
<ul>
<li><code>#!</code> or <code></code> - All todos</li>
<li><code>#!active</code> - Only the incomplete todos</li>
<li><code>#!complete</code> - Only the completed todos</li>
</ul>
<p>Also, the <em>All</em>, <em>Active</em>, and <em>Completed</em> buttons should
link to those pages and a <code>class='selected'</code> property should
be added if they represent the current page.</p>
<h3>What you need to know</h3>
<ul>
<li><p><a href="../../can-route.html" title="Manage browser history and client state by synchronizing the window.location.hash with a map.">can-route</a> is used to connect a <code>DefineMap</code>'s properties
to the URL.  This is done with <a href="../../can-route.data.html" title="This is the internal map underlying can-route. It can be set in order to cross-bind a top level state object (Application ViewModel) to can-route.">data</a> like:</p>
<pre><code class="language-js">route.data = new AppViewModel();
</code></pre></li>
<li><p><a href="../../can-route.html" title="Manage browser history and client state by synchronizing the window.location.hash with a map.">can-route</a> can create pretty routing rules.  For example,
if <code>#!login</code> should set the <code>page</code> property of the
<code>AppViewModel</code> to <code>&quot;login&quot;</code>, use <code>route()</code> like:</p>
<pre><code class="language-js">route(&quot;{page}&quot;);
</code></pre></li>
<li><p><a href="../../can-route.ready.html" title="Initializes can-route.">ready</a> initializes the connection between the
url and the <code>AppViewModel</code>.  After you've created all
your application's pretty routing rules, call it like:</p>
<pre><code class="language-js">route.ready()
</code></pre></li>
<li><p>The <a href="../../can-stache/helpers/route.html" title="Adds stache helpers that use can-route.">can-stache/helpers/route</a> module provides helpers
that use <a href="../../can-route.html" title="Manage browser history and client state by synchronizing the window.location.hash with a map.">can-route</a>.</p>
<p><a href="../../can-stache.helpers.routeCurrent.html" title="Returns if the hash values match the can-route's current properties.">{{#routeCurrent hash}}</a>
returns truthy if the current route matches its first parameters properties.</p>
<pre><code class="language-html">{{#if routeCurrent(page='login',true)}}
  You are on the login page.
{{/if}}
</code></pre>
<p><a href="../../can-stache.helpers.routeUrl.html" title="Returns a url using route.url.">{{routeUrl hashes}}</a> returns a url that will
set its first parameters properties:</p>
<pre><code>&lt;a href=&quot;{{routeUrl page='login'}}&quot;&gt;Login&lt;/a&gt;
</code></pre></li>
</ul>
<h3>The solution</h3>
<pre><code>npm install can-route --save
</code></pre>
<pre><code class="language-js">// index.js
var view = require(&quot;./index.stache&quot;);
var DefineMap = require(&quot;can-define/map/&quot;);
var Todo = require(&quot;~/models/todo&quot;);
var route = require(&quot;can-route&quot;);
require(&quot;~/models/todos-fixture&quot;);

var AppViewModel = DefineMap.extend(&quot;AppViewModel&quot;, {
    appName: {type: &quot;string&quot;, serialize: false},
    filter: &quot;string&quot;,
    allTodos: {
        get: function(lastSet, resolve){
            Todo.getList({}).then(resolve);
        }
    },
    get todosList() {
        if(this.allTodos) {
            if(this.filter === &quot;complete&quot;) {
                return this.allTodos.complete;
            } else if(this.filter === &quot;active&quot;) {
                return this.allTodos.active;
            } else {
                return this.allTodos;
            }
        }
    },
    get allChecked() {
        return this.todosList &amp;&amp; this.todosList.allComplete;
    },
    set allChecked(newVal) {
        this.todosList &amp;&amp; this.todosList.updateCompleteTo(newVal);
    }
});

var appVM = window.appVM = new AppViewModel({
    appName: &quot;TodoMVC&quot;
});

route.data = appVM;
route(&quot;{filter}&quot;);
route.ready();

var frag = view(appVM);
document.body.appendChild(frag);

require(&quot;can-todomvc-test&quot;)(appVM);

</code></pre>
<p><span line-highlight='5,9,11-26,39-41,only'></span></p>
<pre><code class="language-html">&lt;!-- index.stache --&gt;
&lt;can-import from=&quot;~/components/todo-create/&quot;/&gt;
&lt;can-import from=&quot;~/components/todo-list/&quot;/&gt;
&lt;can-import from=&quot;can-stache/helpers/route&quot;/&gt;
&lt;section id=&quot;todoapp&quot;&gt;
    &lt;header id=&quot;header&quot;&gt;
        &lt;h1&gt;{{appName}}&lt;/h1&gt;
        &lt;todo-create/&gt;
    &lt;/header&gt;
    &lt;section id=&quot;main&quot; class=&quot;&quot;&gt;
        &lt;input id=&quot;toggle-all&quot; type=&quot;checkbox&quot;
          {($checked)}=&quot;allChecked&quot;
          {$disabled}=&quot;todosList.saving.length&quot;/&gt;
        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;
        &lt;todo-list {todos}=&quot;todosList&quot;/&gt;
    &lt;/section&gt;
    &lt;footer id=&quot;footer&quot; class=&quot;&quot;&gt;
        &lt;span id=&quot;todo-count&quot;&gt;
            &lt;strong&gt;{{allTodos.active.length}}&lt;/strong&gt; items left
        &lt;/span&gt;
        &lt;ul id=&quot;filters&quot;&gt;
            &lt;li&gt;
                &lt;a href=&quot;{{routeUrl filter=undefined}}&quot;
                    {{#routeCurrent filter=undefined}}class='selected'{{/routeCurrent}}&gt;
                    All
                &lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;{{routeUrl filter='active'}}&quot;
                    {{#routeCurrent filter='active'}}class='selected'{{/routeCurrent}}&gt;
                    Active
                &lt;/a&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;a href=&quot;{{routeUrl filter='complete'}}&quot;
                    {{#routeCurrent filter='complete'}}class='selected'{{/routeCurrent}}&gt;
                    Completed
                &lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;button id=&quot;clear-completed&quot;
            ($click)=&quot;allTodos.destroyComplete()&quot;&gt;
            Clear completed ({{allTodos.complete.length}})
        &lt;/button&gt;
    &lt;/footer&gt;
&lt;/section&gt;

</code></pre>
<p><span line-highlight='4,23-26,29-32,35-38,only'></span></p>

</section>

  


<script type="text/javascript">
  window.docObject = {"src":{"path":"docs/can-guides/commitment/recipes/todomvc-with-steal/todomvc-with-steal.md"},"description":"This guide walks through building TodoMVC with StealJS.\n\n","name":"guides/recipes/todomvc-with-steal","title":"TodoMVC with StealJS","type":"page","parent":"guides/recipes","comment":" ","pathToRoot":"../.."};
</script>
</article>
	  
        <footer><p>CanJS is part of <a href="https://donejs.com" target="_blank">DoneJS</a>. Created and maintained by the core <a href="https://donejs.com/About.html#team" target="_blank">DoneJS team</a> and <a href="https://www.bitovi.com" target="_blank">Bitovi</a>. <strong>Currently 3.8.1.</strong></p>
</footer>
	      </div>
  </div>
</div>

		
			<script>
				steal = {
				  	instantiated: {
				    	"bundles/bit-docs-site/static.css!$css" : null
				  	}
			  	};
			</script>
			<script type='text/javascript' data-main="bit-docs-site/static" src="../../static/node_modules/steal/steal.production.js"></script>
		
		<script async defer src="https://buttons.github.io/buttons.js"></script>

		<!-- root-level elements with attributes necessary for the app -->
		<div path-prefix="../.." />
		
	</body>
</html>
