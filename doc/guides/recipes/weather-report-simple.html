<!DOCTYPE html>
<!--####################################################################
	THIS IS A GENERATED FILE -- ANY CHANGES MADE WILL BE OVERWRITTEN

	INSTEAD CHANGE:
	source: [object Object]
	@page guides/recipes/weather-report-simple
######################################################################## -->
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>CanJS - Weather Report Guide (Simple)</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	
		<link rel="stylesheet" type="text/css" href="../../static/bundles/bit-docs-site/static.css">
		<link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64" href="/docs/images/canjs_favicon.ico">
		<link rel="apple-touch-icon" sizes="57x57" href="../../../docs/images/canjs_favicon_57x57.png">
		<link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../../docs/images/canjs_favicon_57x57.png">
		<link rel="apple-touch-icon" sizes="72x72" href="../../../docs/images/canjs_favicon_72x72.png">
		<link rel="apple-touch-icon" sizes="114x114" href="../../../docs/images/canjs_favicon_114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="../../../docs/images/canjs_favicon_128x128.png">
		<link rel="apple-touch-icon" sizes="144x144" href="../../../docs/images/canjs_favicon_144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="../../../docs/images/canjs_favicon_152x152.png">
		<meta content="yes" name="apple-mobile-web-app-capable">
	  	<meta name="apple-mobile-web-app-status-bar-style" content="white-translucent">
	
	
		<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-2302003-11', 'auto');
			ga('send', 'pageview');
		</script>
	
</head>
	<body>
		<input type="checkbox" id="nav-trigger" class="nav-trigger"/>
		<label for="nav-trigger">Menu</label>
	  	<div id="everything">
  <div id="left" class="column">
    <div class="top-left">
      
          <div class="brand">
	<div class="logo">
		<a href="../../../index.html" alt="CanJS"></a>
		<div class="dropdown project-dropdown">
			<a href="https://donejs.com/">DoneJS</a>
			<a href="https://stealjs.com/">StealJS</a>
			<a href="https://jquerypp.com/">jQuery++</a>
			<a href="https://funcunit.com/">FuncUnit</a>
			<a href="https://documentjs.com/">DocumentJS</a>
		</div>
	</div>
	<div class="version">
		<div class="version-number">
			3.8.1
		</div>
		<div class="dropdown version-dropdown">
			
				<a href="https://v2.canjs.com">2.3.27</a>
			
		</div>
	</div>
</div>
<div class="search-bar">
	<div class="search-wrap" style="display:none;">
		<span class="search-icon"></span>
		<input
			type="text"
			size="6"
			class="search"
			placeholder="Search"
			autocomplete="off"
			autocorrect="off"
			autocapitalize="none"
			spellcheck="false"/>
			<span class="search-icon-cancel"></span>
	</div>
</div>


      
    </div>
    <div class="bottom-left">
       <div class="social-side-container">
        <ul class="social-side">
  <li>
    <a class="header-mobile github" href="https://github.com/canjs/canjs" target="_blank"><img class="social-icon-small" src="../../../docs/images/github.png">Github</a>
  </li>
  <li>
    <a class="header-mobile twitter" href="https://twitter.com/canjs" target="_blank"><img class="social-icon-small" src="../../../docs/images/twitter.png">Twitter</a>
  </li>
</ul>
<ul class="social-side">
  <li>
    <a class="header-mobile" href="https://gitter.im/canjs/canjs" target="_blank">Chat</a>
  </li>
  <li>
    <a class="header-mobile" href="http://forums.donejs.com/c/canjs" target="_blank">Forum</a>
  </li>
</ul>

      </div>
        
            
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../about.html"
							title="Welcome to CanJS! Learn about CanJS’s mission &amp; technical highlights, who uses CanJS, and our future roadmap.">
							About
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						parent
           						expanded">
						<a class="page"
							href="../../guides.html"
							title="Welcome to CanJS! These guides are here to help you develop and improve your relationship with CanJS. After all, picking a JavaScript framework is a commitment.  We want CanJS to be the framework you marry.  This page helps you know how to advance through the different stages of this relationship:">
							Guides
						</a>
						
	<ul>
		
			
				
					<li>
						<span>experiment</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../chat.html"
							title="This guide will walk you through building a real-time chat application with CanJS’s Core libraries.  It takes about 30 minutes to complete.">
							Chat Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../todomvc.html"
							title="This guide will walk you through building a slightly modified version of TodoMVC with CanJS’s Core libraries and can-fixture. It takes about 1 hour to complete.">
							TodoMVC Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../atm.html"
							title="This guide will walk you through building and testing an Automated Teller Machine (ATM) application with CanJS’s
Core libraries.  You’ll learn how to do test driven development (TDD)
and manage complex state.  It takes about 2 hours to complete.">
							ATM Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../setup.html"
							title="Get started with CanJS by installing it with npm, using a JS&amp;nbsp;Bin, or just adding it to an HTML page with a &lt;script&gt; tag.">
							Setting up CanJS
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li>
						<span>commitment</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../api.html"
							title="This page walks through how to use and understand CanJS’s API documentation.">
							API Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../migrate-3.html"
							title="This guide walks you through the step-by-step process to upgrade a 2.x app to CanJS 3.">
							Migrating to CanJS 3
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						parent
           						expanded">
						<a class="page"
							href="../recipes.html"
							title="A listing of small examples that are useful for learning CanJS.">
							Recipes
						</a>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="file-navigator-advanced.html"
							title="This guide walks you through building a file navigation widget.  It takes about 45 minutes to complete.  It was written with
CanJS 3.4. Checkout the file-navigator-simple
for an easier example that produces similar functionality.">
							File Navigator Guide (Advanced)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="file-navigator-simple.html"
							title="This guide walks you through building a simple file navigation widget.  It takes about 25 minutes to complete.  It was written with
CanJS 3.4. Checkout the file-navigator-advanced
for an example that makes AJAX requests for its data and uses can-component.">
							File Navigator Guide (Simple)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="playlist-editor.html"
							title="Learn how to use YouTube&#x27;s API to search for videos and make a playlist.  This makes authenticated requests with OAuth2. It uses jQuery++ for
drag/drop events. It shows using custom attributes and custom events.  This guide takes
an hour to complete.">
							Playlist Editor (Advanced)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="todomvc-with-steal.html"
							title="This guide walks through building TodoMVC with StealJS.">
							TodoMVC with StealJS
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="weather-report-advanced.html"
							title="This guides you through extending the Simple Weather Report Guide to remove imperative code and automatically look up the user’s location using the
browser’s geolocation API.  Both of these will be done with event streams.
This guide continues where the Simple Weather Report Guide left off.  It takes about 25 minutes to complete.  It was written with CanJS 3.8.">
							Weather Report Guide (Advanced)
						</a>
						

					</li>
				
			
		
			
				
					<li class="current
           						parent
           						expanded">
						<a class="page"
							href="weather-report-simple.html"
							title="This guide walks you through building a simple weather report widget.  It takes about 25 minutes to complete.  It was written with
CanJS 3.5.">
							Weather Report Guide (Simple)
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li>
						<span>contribute</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/adding-ecosystem-modules.html"
							title="Learn how to add your module to this site.">
							New Package
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/bug-report.html"
							title="Learn how to submit a bug report.">
							Bug Report
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/code.html"
							title="Learn how contribute a code change to CanJS.">
							Code
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/documentation.html"
							title="Learn how to improve CanJS’s site and documentation.">
							Documentation
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/evangelism.html"
							title="Learn about resources that can help you spread the word about CanJS.">
							Evangelism
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/feature-suggestion.html"
							title="Learn how to suggest a feature.">
							Feature Suggestion
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contributing/releases.html"
							title="Release and hosting information for CanJS maintainers.">
							Releases
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../api.html"
							title="Welcome to the CanJS docs! Learn about all the packages that make-up CanJS &amp; how they work together to help you build amazing applications!">
							API Docs
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../community.html"
							title="Get involved with one of the most inviting communities on the internet!">
							Community
						</a>
						

					</li>
				
			
		
	</ul>


        
        <div class="search-results-container">
	<div class="search-results-wrap"></div>
</div>

    </div>
  </div>
  <div id="right" class="column">
    <div class="top-right">
      <div class="top-right-top">
	<ul class="top-right-bitovi">
	  	<li class="dropdown">
	    	<a href="https://www.bitovi.com" class="bitovi icon-bits">Bitovi</a>
	    	<ul class="dropdown-menu">
	      		<li><a href="https://www.bitovi.com/">Bitovi.com</a></li>
	      		<li><a href="https://www.bitovi.com/blog">Blog</a></li>
	      		<li><a href="https://www.bitovi.com/design">Design</a></li>
	      		<li><a href="https://www.bitovi.com/development">Development</a></li>
	      		<li><a href="https://www.bitovi.com/training">Training</a></li>
	      		<li><a href="https://www.bitovi.com/open-source">Open Source</a></li>
	      		<li><a href="https://www.bitovi.com/about">About</a></li>
	      		<li><a href="https://www.bitovi.com/contact">Contact Us</a></li>
	    	</ul>
	  	</li>
	</ul>
	<div class="brand">
		<div class="logo">
			<a href="../../../index.html" alt="CanJS"></a>
		</div>
	</div>
	<ul class="top-right-links">
  <li>
    <a href="https://gitter.im/canjs/canjs">Chat</a>
  </li>
  <li>
    <a href="http://forums.donejs.com/c/canjs">Forum</a>
  </li>
  <li>
    <a class="github-button nav-social" href="https://github.com/canjs/canjs" data-count-href="/canjs/canjs/stargazers" data-count-api="/repos/canjs/canjs#stargazers_count">Star</a>
  </li>
  <li>
    <a href="https://twitter.com/canjs" class="twitter-follow-button nav-social" data-show-count="true" data-show-screen-name="false">Follow @canjs</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </li>
</ul>
</div>
<div class="breadcrumb">
	
		<li><a href="../../../index.html">CanJS</a></li>
		<li> / </li>
	
		<li><a href="../../guides.html">Guides</a></li>
		<li> / </li>
	
		<li><a href="../recipes.html">Recipes</a></li>
		<li> / </li>
	
	
	<li><a href="weather-report-simple.html">Weather Report Guide (Simple)</a></li>
	
	<li class="breadcrumb-dropdown-separator"> / </li>
	<li class="breadcrumb-dropdown">
		<a> On this page</a>
		<ul class="on-this-page"></ul>
	</li>
	<div class="nav-toggle" title="Back to top"></div>
</div>


    </div>
    <div class="bottom-right">
      <article>
  <section class="title">
	<div class="page-type">
		<h1>Weather Report Guide (Simple)</h1>
			<ul class="title-social">
				
				
				<li>
					<a class="button-link" href="//github.com/canjs/canjs/edit/master/docs/can-guides/commitment/recipes/weather-report/weather-report.md">Edit on GitHub</a>
				</li>
				
			</ul>
	</div>
	<div class="clear-both"></div>
	
  
	<section class="description">
    <p>This guide walks you through building a simple weather report widget.  It takes about 25 minutes to complete.  It was written with
CanJS 3.5.</p>

</section>

  
	
</section>
<section class="on-this-page-table">
</section>











  
    <section class="body">
    <p>The final widget looks like:</p>
<p><a class="jsbin-embed" href="https://jsbin.com/vujugel/1/embed?html,js,output">JS Bin on jsbin.com</a></p>
<p>To use the widget:</p>
<ol>
<li><strong>Enter</strong> a location (example: <em>Chicago</em>)</li>
<li>If the location name isn’t unique, <strong>click</strong> on the intended location.</li>
<li>See the 10-day forecast for your selected city.</li>
</ol>
<p><strong>Start this tutorial by cloning the following JSBin</strong>:</p>
<p><a class="jsbin-embed" href="https://jsbin.com/fudakiz/1/embed?html,output">JS Bin on jsbin.com</a></p>
<p>This JSBin has initial prototype HTML and CSS which is useful for
getting the application to look right.</p>
<p>The following sections are broken down into:</p>
<ul>
<li>Problem — A description of what the section is trying to accomplish.</li>
<li>Things to know — Information about CanJS that is useful for solving the problem.</li>
<li>Solution — The solution to the problem.</li>
</ul>
<h2>Setup</h2>
<h3>The problem</h3>
<p>Get the basic setup for a CanJS app (in a JSBin) setup by:</p>
<ol>
<li>Creating a template that outputs the pre-constructed HTML.</li>
<li>Defining a <code>WeatherViewModel</code> constructor function.</li>
<li>Rendering the template with an instance of <code>WeatherViewModel</code>.</li>
<li>Inserting the result of the rendered template into the page.</li>
</ol>
<h3>Things to know</h3>
<ul>
<li><p>A <a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a> template is used to render data into a document fragment:</p>
<pre><code class="language-js">var template = can.stache(&quot;&lt;h1&gt;{{message}}&lt;/h1&gt;&quot;);
var frag = template({message: &quot;Hello World&quot;});
frag //-&gt; &lt;h1&gt;Hello World&lt;/h1&gt;
</code></pre></li>
<li><p><a href="../../can-define/map/map.html" title="Create observable objects.">can.DefineMap</a> can be used to define the behavior of observable objects like:</p>
<pre><code class="language-js">var Type = can.DefineMap.extend({
    message: &quot;string&quot;
});
</code></pre></li>
<li><p>Instances of these <a href="../../can-define/map/map.html" title="Create observable objects.">can.DefineMap</a> types are often used
as a ViewModel that controls the behavior of a <a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a> template (or
<a href="../../can-component.html" title="Create a custom element that can be used to manage widgets or application logic.">can-component</a>).</p>
<pre><code class="language-js">var MessageViewModel = can.DefineMap.extend({
    message: &quot;string&quot;
});

var messageVM = new MessageViewModel();
var frag = template(messageVM)
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Update the <code>HTML</code> tab to wrap the template in a <code>script</code> tag:</p>
<pre><code class="language-html">&lt;script id=&quot;app-template&quot; type=&quot;text/stache&quot;&gt;
  &lt;div class=&quot;weather-widget&quot;&gt;
    &lt;div class=&quot;location-entry&quot;&gt;
      &lt;label for=&quot;location&quot;&gt;Enter Your location:&lt;/label&gt;
      &lt;input id=&quot;location&quot; type='text'/&gt;
    &lt;/div&gt;

    &lt;p class=&quot;loading-message&quot;&gt;
      Loading places…
    &lt;/p&gt;

    &lt;div class=&quot;location-options&quot;&gt;
      &lt;label&gt;Pick your place:&lt;/label&gt;
      &lt;ul&gt;
        &lt;li&gt;Some Place&lt;/li&gt;
        &lt;li&gt;Another Place&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;

    &lt;div class=&quot;forecast&quot;&gt;
      &lt;h1&gt;10-day Chicago Weather Forecast&lt;/h1&gt;
      &lt;ul&gt;
        &lt;li&gt;
          &lt;span class='date'&gt;Today&lt;/span&gt;
          &lt;span class='description scattered-showers'&gt;Scattered Showers&lt;/span&gt;
          &lt;span class='high-temp'&gt;100&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
          &lt;span class='low-temp'&gt;-10&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
        &lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/script&gt;
</code></pre>
<p><span line-highlight='1,32,only'></span>
Update the <code>JS</code> tab to:</p>
<ul>
<li>Define a ViewModel.</li>
<li>Create an instance of the ViewModel .</li>
<li>Load the <code>app-template</code> template.</li>
<li>Render the template with the ViewModel instance.</li>
<li>Insert the rendered result into the page.</li>
</ul>
<pre><code class="language-js">var WeatherViewModel = can.DefineMap.extend({

});

var vm = new WeatherViewModel();

var template = can.stache.from(&quot;app-template&quot;);
var frag = template( vm );
document.body.appendChild(frag);
</code></pre>
<p><span line-highlight='1-9'></span></p>
<h2>Allow a user to enter a location</h2>
<h3>The problem</h3>
<p>We want an <code>input</code> element to:</p>
<ul>
<li>Allow a person to type a location to search for weather.</li>
<li>Show the user the location they typed.</li>
</ul>
<h3>Things to know</h3>
<ul>
<li><p>There are <a href="../../can-define.types.propDefinition.html" title="Defines the type, initial value, and get, set, and serialize behavior for an
observable property.  These behaviors can be specified with as an Object, String,
Constructor function, Array, a getter expression, or setter expression.">many ways</a> to define a property on
a <code>DefineMap</code>.  The simplest way is <code>propName: &quot;&lt;TYPE&gt;&quot;</code> like:</p>
<pre><code class="language-js">DefineMap.extend({
  property: &quot;string&quot;    
})
</code></pre></li>
<li><p>The <a href="../../can-stache-bindings.toParent.html" title="One-way bind a value in the current viewModel to the parent scope.">{^to-parent}</a> can set an input’s <code>value</code> to
a ViewModel property like:</p>
<pre><code class="language-html">&lt;input {^$value}=&quot;property&quot;/&gt;
</code></pre></li>
<li><p>A <a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a> template uses
<a href="../../can-stache.tags.escaped.html" title="Insert the value of the expression into the output of the template.">{{key}}</a> magic tags to insert data into
the HTML output like:</p>
<pre><code class="language-html">{{property}}
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Update the template in the <code>HTML</code> tab to:</p>
<ol>
<li>Update <code>location</code> on the ViewModel when the input changes.</li>
<li>Show value of the ViewModel’s <code>location</code> property.</li>
</ol>
<pre><code class="language-html">&lt;script id=&quot;app-template&quot; type=&quot;text/stache&quot;&gt;
  &lt;div class=&quot;weather-widget&quot;&gt;
    &lt;div class=&quot;location-entry&quot;&gt;
      &lt;label for=&quot;location&quot;&gt;Enter Your location:&lt;/label&gt;
      &lt;input id=&quot;location&quot; {^$value}=&quot;location&quot; type=&quot;text&quot;/&gt;
    &lt;/div&gt;

    &lt;p class=&quot;loading-message&quot;&gt;
      Loading places…
    &lt;/p&gt;

    &lt;div class=&quot;location-options&quot;&gt;
      &lt;label&gt;Pick your place:&lt;/label&gt;
      &lt;ul&gt;
        &lt;li&gt;Some Place&lt;/li&gt;
        &lt;li&gt;Another Place&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;

    &lt;div class=&quot;forecast&quot;&gt;
      &lt;h1&gt;10-day {{location}} Weather Forecast&lt;/h1&gt;
      &lt;ul&gt;
        &lt;li&gt;
          &lt;span class='date'&gt;Today&lt;/span&gt;
          &lt;span class='description scattered-showers'&gt;Scattered Showers&lt;/span&gt;
          &lt;span class='high-temp'&gt;100&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
          &lt;span class='low-temp'&gt;-10&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
        &lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/script&gt;
</code></pre>
<p><span line-highlight='5,21,only'></span></p>
<p>Update the <code>JS</code> tab to:</p>
<ol>
<li>Define a <code>location</code> property as a string.</li>
</ol>
<pre><code class="language-js">var WeatherViewModel = can.DefineMap.extend({
  location: &quot;string&quot;
});

var vm = new WeatherViewModel();

var template = can.stache.from(&quot;app-template&quot;);
var frag = template( vm );
document.body.appendChild(frag);
</code></pre>
<p><span line-highlight='2'></span></p>
<h2>Get and display the places for the user’s location name</h2>
<h3>The problem</h3>
<p>Once the user has entered a location name, we need to get which
“place” it is.  For example, a user might enter Paris, but we don’t know if
they mean the Paris in France or the one in Illinois.  We need to get a
list of matching places for the location name and display the matching places
on the page.</p>
<h3>Things to know</h3>
<ul>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/get">ES5 Getter Syntax</a> can
be used to define a <code>DefineMap</code> property that changes when another property changes.  For example,
the following defines an <code>excitedMessage</code> property that always has a <code>!</code> after the <code>message</code> property:</p>
<pre><code class="language-js">DefineMap.extend({
  message: &quot;string&quot;,
  get excitedMessage(){
    return this.message+&quot;!&quot;;
  }
});
</code></pre></li>
<li><p><a href="https://developer.yahoo.com/yql/console/">YQL</a> provides a service endpoint for
retrieving a list of places that match some text.  For example, the following requests all
places that match <code>Paris</code>:</p>
<pre><code>https://query.yahooapis.com/v1/public/yql?
  format=json&amp;
  q=select * from geo.places where text=&quot;Paris&quot;
</code></pre>
<p>The list of matched places will be in the response data’s <code>data.query.results.place</code> property.
If there is only a single match, <code>place</code> will be an object instead of an array.</p></li>
<li><p>The <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">fetch API</a> is an easy way to make requests
to a URL and get back JSON.  Use it like:</p>
<pre><code class="language-js">fetch(url).then(function(response){
    return response.json();
}).then(function(data){

});
</code></pre></li>
<li><p><a href="../../can-util/js/param/param.html" title="Deprecated. Use can-param instead.">can.param</a> is able to convert an object into a
query string format like:</p>
<pre><code class="language-js">can.param({format: &quot;json&quot;, q: &quot;select&quot;}) //-&gt; &quot;format=json&amp;q=select&quot;
</code></pre></li>
<li><p>Use <a href="../../can-stache.helpers.if.html" title="can-stache.helpers.if">{{#if value}}</a> to do <code>if/else</code> branching in <code>can-stache</code>.</p></li>
<li><p>Use <a href="../../can-stache.helpers.each.html" title="">{{#each value}}</a> to do looping in <code>can-stache</code>.</p></li>
<li><p><code>Promise</code>s are observable in <a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a>.  Given a promise <code>somePromise</code>, you can:</p>
<ul>
<li>Check if the promise is loading like: <code>{{#if somePromise.isPending}}</code>.</li>
<li>Loop through the resolved value of the promise like: <code>{{#each somePromise.value}}</code>.</li>
</ul></li>
</ul>
<h3>The solution</h3>
<ol>
<li>Show a “Loading places…” message while we wait on data.</li>
<li>Once the places are resolved, list each place’s name, state, country and type.</li>
</ol>
<p>Update the template in the <code>HTML</code> tab to:</p>
<pre><code class="language-html">&lt;script id=&quot;app-template&quot; type=&quot;text/stache&quot;&gt;
  &lt;div class=&quot;weather-widget&quot;&gt;
    &lt;div class=&quot;location-entry&quot;&gt;
      &lt;label for=&quot;location&quot;&gt;Enter Your location:&lt;/label&gt;
      &lt;input id=&quot;location&quot; {^$value}=&quot;location&quot; type=&quot;text&quot;/&gt;
    &lt;/div&gt;

    {{#if placesPromise.isPending}}
      &lt;p class=&quot;loading-message&quot;&gt;
        Loading places…
      &lt;/p&gt;
    {{/if}}

    {{#if placesPromise.isResolved}}
      &lt;div class=&quot;location-options&quot;&gt;
        &lt;label&gt;Pick your place:&lt;/label&gt;
        &lt;ul&gt;
          {{#each placesPromise.value}}
            &lt;li&gt;
              {{name}}, {{admin1.content}}, {{country.code}} ({{placeTypeName.content}})
            &lt;/li&gt;
          {{/each}}
        &lt;/ul&gt;
      &lt;/div&gt;
    {{/if}}

    &lt;div class=&quot;forecast&quot;&gt;
      &lt;h1&gt;10-day {{location}} Weather Forecast&lt;/h1&gt;
      &lt;ul&gt;
        &lt;li&gt;
          &lt;span class='date'&gt;Today&lt;/span&gt;
          &lt;span class='description scattered-showers'&gt;Scattered Showers&lt;/span&gt;
          &lt;span class='high-temp'&gt;100&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
          &lt;span class='low-temp'&gt;-10&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
        &lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/script&gt;
</code></pre>
<p><span line-highlight='8,12,14,18,19,20,21,22,25,only'></span>
Update the <code>JS</code> tab to:</p>
<ol>
<li>Define a <code>placesPromise</code> property that will represent the loading places.</li>
<li>If the user has typed in at least two characters, we fetch the matching places.</li>
<li>If only a single place is returned, we still convert it into an array so the data
stays consistent.</li>
</ol>
<pre><code class="language-js">var yqlURL = &quot;//query.yahooapis.com/v1/public/yql?&quot;;

var WeatherViewModel = can.DefineMap.extend({
  location: &quot;string&quot;,
  get placesPromise(){
    if(this.location &amp;&amp; this.location.length &gt; 2) {
      return fetch(
        yqlURL +
        can.param({
          q: 'select * from geo.places where text=&quot;'+this.location+'&quot;',
          format: &quot;json&quot;
        })
      ).then(function(response){
        return response.json();
      }).then(function(data){
        console.log(data);
        if(Array.isArray(data.query.results.place)) {
          return data.query.results.place;
        } else {
          return [data.query.results.place];
        }
      });
    }
  }
});

var vm = new WeatherViewModel();

var template = can.stache.from(&quot;app-template&quot;);
var frag = template( vm );
document.body.appendChild(frag);
</code></pre>
<p><span line-highlight='1,5-24,only'></span></p>
<h2>Allow a user to select a place</h2>
<h3>The problem</h3>
<p>When a user clicks on a place, we need to indicate their selection.</p>
<h3>Things to know</h3>
<ul>
<li><p>Use <a href="../../can-stache-bindings.event.html" title="Respond to events on elements or component ViewModels.">($EVENT)</a> to listen to an event on an element and call a method in <code>can-stache</code>.  For example, the following calls <code>doSomething()</code> when the <code>&lt;div&gt;</code> is clicked.</p>
<pre><code class="language-html">&lt;div ($click)=&quot;sayHi()&quot;&gt; … &lt;/div&gt;
</code></pre></li>
<li><p><code>this</code> in a stache template refers to the current context of a template or section.</p>
<p>For example, the <code>this</code> in <code>this.name</code> refers to the <code>context</code> object:</p>
<pre><code class="language-javascript">var template = stache(&quot;{{this.name}}&quot;);
var context = {name: &quot;Justin&quot;};
template(context);
</code></pre>
<p>Or, when looping through a list of items, <code>this</code> refers to each item:</p>
<pre><code class="language-html">{{#each items}}
  &lt;li&gt;{{this.name}}&lt;/li&gt; &lt;!-- this is each item in items --&gt;
{{/each}}
</code></pre></li>
</ul>
<ul>
<li><p>The <a href="../../can-define.types.html" title="Defines the type, initial value, and get, set, and serialize behavior for an
observable property. All type converters leave null and undefined as is except for
the &quot;htmlbool&quot; type converter.">“any” type</a> can be used to define a property as
accepting any data type like:</p>
<pre><code class="language-js">var MessageViewModel = can.DefineMap.extend({
    message: &quot;string&quot;,
    metaData: &quot;any&quot;
})
</code></pre></li>
<li><p><code>can.DefineMap</code> can also have methods:</p>
<pre><code class="language-js">var MessageViewModel = can.DefineMap.extend({
    message: &quot;string&quot;,
    metaData: &quot;any&quot;,
    sayHi: function(){
      this.message = &quot;Hello&quot;;
    }
});
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Update the template in the <code>HTML</code> tab to:</p>
<ol>
<li>When a <code>&lt;li&gt;</code> is clicked on, call <code>pickPlace</code> with the corresponding <code>place</code>.</li>
<li>When a <code>place</code> has been set, write out the forecast header.</li>
</ol>
<pre><code class="language-html">&lt;script id=&quot;app-template&quot; type=&quot;text/stache&quot;&gt;
  &lt;div class=&quot;weather-widget&quot;&gt;
    &lt;div class=&quot;location-entry&quot;&gt;
      &lt;label for=&quot;location&quot;&gt;Enter Your location:&lt;/label&gt;
      &lt;input id=&quot;location&quot; {^$value}=&quot;location&quot; type=&quot;text&quot;/&gt;
    &lt;/div&gt;

    {{#if placesPromise.isPending}}
      &lt;p class=&quot;loading-message&quot;&gt;
        Loading places…
      &lt;/p&gt;
    {{/if}}

    {{#if placesPromise.isResolved}}
      &lt;div class=&quot;location-options&quot;&gt;
        &lt;label&gt;Pick your place:&lt;/label&gt;
        &lt;ul&gt;
          {{#each placesPromise.value}}
            &lt;li ($click)=&quot;../pickPlace(this)&quot;&gt;
              {{name}}, {{admin1.content}}, {{country.code}} ({{placeTypeName.content}})
            &lt;/li&gt;
          {{/each}}
        &lt;/ul&gt;
      &lt;/div&gt;
    {{/if}}

    {{#if place}}
      &lt;div class=&quot;forecast&quot;&gt;
        &lt;h1&gt;10-day {{place.name}} Weather Forecast&lt;/h1&gt;
        &lt;ul&gt;
          &lt;li&gt;
            &lt;span class='date'&gt;Today&lt;/span&gt;
            &lt;span class='description scattered-showers'&gt;Scattered Showers&lt;/span&gt;
            &lt;span class='high-temp'&gt;100&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
            &lt;span class='low-temp'&gt;-10&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
    {{/if}}
  &lt;/div&gt;
&lt;/script&gt;
</code></pre>
<p><span line-highlight='19,27,29,39,only'></span>
Update the <code>JS</code> tab to:</p>
<ol>
<li>Define a <code>place</code> property as taking any data type.</li>
<li>Define a <code>pickPlace</code> method that sets the place property.</li>
</ol>
<pre><code class="language-js">var yqlURL = &quot;//query.yahooapis.com/v1/public/yql?&quot;;

var WeatherViewModel = can.DefineMap.extend({
  location: &quot;string&quot;,
  get placesPromise(){
    if(this.location &amp;&amp; this.location.length &gt; 2) {
      return fetch(
          yqlURL+
          can.param({
            q: 'select * from geo.places where text=&quot;'+this.location+'&quot;',
            format: &quot;json&quot;
          })
      ).then(function(response){
          return response.json();
      }).then(function(data){
          console.log(data);
          if(Array.isArray(data.query.results.place)) {
            return data.query.results.place;
          } else {
            return [data.query.results.place];
          }
      });
    }
  },
  place: &quot;any&quot;,
  pickPlace: function(place){
    this.place = place;
  }
});

var vm = new WeatherViewModel();

var template = can.stache.from(&quot;app-template&quot;);
var frag = template( vm );
document.body.appendChild(frag);
</code></pre>
<p><span line-highlight='25-28,only'></span></p>
<h2>Get and display the forecast</h2>
<h3>The problem</h3>
<p>Once we’ve selected a place, we need to get and display the forecast data for the
selected place.</p>
<h3>Things to know</h3>
<ul>
<li><p>ViewModel methods can be <a href="../../can-stache/expressions/call.html" title="">called</a> within a <a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a> template like:</p>
<pre><code>{{myMethod(someValue)}}
</code></pre></li>
<li><p><a href="https://developer.yahoo.com/yql/console/">YQL</a> provides a service endpoint for
retrieving a forecast that matches a <code>place</code>’s <code>woeid</code>.  For example, the following requests the forecast
for Paris, France’s <code>woeid</code>:</p>
<pre><code>https://query.yahooapis.com/v1/public/yql?
  format=json&amp;
  q=select * from weather.forecast where woeid=615702
</code></pre></li>
<li><p>The stylesheet includes icons for classNames that match: <code>sunny</code>, <code>mostly-cloudy</code>, <code>scattered-thunderstorms</code>, etc.</p></li>
</ul>
<h3>The solution</h3>
<p>Update the template in the <code>HTML</code> tab to:</p>
<ol>
<li>Display each forecast day’s details (date, text, high, and low).</li>
<li>Use the <code>toClassName</code> method to convert the forecast’s <code>text</code> into a <code>className</code> value that
will be matched by the stylesheet.</li>
</ol>
<pre><code class="language-html">&lt;script id=&quot;app-template&quot; type=&quot;text/stache&quot;&gt;
  &lt;div class=&quot;weather-widget&quot;&gt;
    &lt;div class=&quot;location-entry&quot;&gt;
      &lt;label for=&quot;location&quot;&gt;Enter Your location:&lt;/label&gt;
      &lt;input id=&quot;location&quot; {^$value}=&quot;location&quot; type=&quot;text&quot;/&gt;
    &lt;/div&gt;

    {{#if placesPromise.isPending}}
      &lt;p class=&quot;loading-message&quot;&gt;
        Loading places…
      &lt;/p&gt;
    {{/if}}

    {{#if placesPromise.isResolved}}
      &lt;div class=&quot;location-options&quot;&gt;
        &lt;label&gt;Pick your place:&lt;/label&gt;
        &lt;ul&gt;
          {{#each placesPromise.value}}
            &lt;li ($click)=&quot;../pickPlace(this)&quot;&gt;
              {{name}}, {{admin1.content}}, {{country.code}} ({{placeTypeName.content}})
            &lt;/li&gt;
          {{/each}}
        &lt;/ul&gt;
      &lt;/div&gt;
    {{/if}}

    {{#if place}}
      &lt;div class=&quot;forecast&quot;&gt;
        &lt;h1&gt;10-day {{place.name}} Weather Forecast&lt;/h1&gt;
        &lt;ul&gt;
          {{#each forecastPromise.value}}
            &lt;li&gt;
              &lt;span class='date'&gt;{{date}}&lt;/span&gt;
              &lt;span class='description {{toClassName(text)}}'&gt;{{text}}&lt;/span&gt;
              &lt;span class='high-temp'&gt;{{high}}&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
              &lt;span class='low-temp'&gt;{{low}}&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
            &lt;/li&gt;
          {{/each}}
        &lt;/ul&gt;
      &lt;/div&gt;
    {{/if}}
  &lt;/div&gt;
&lt;/script&gt;
</code></pre>
<p><span line-highlight='31,33,34,35,36,38,only'></span>
Update the <code>JS</code> tab to:</p>
<ol>
<li>Define a <code>forecastPromise</code> property that gets a list of promises.</li>
<li>Define a <code>toClassName</code> method that lowercases and hyphenates any text passed in.</li>
</ol>
<pre><code class="language-js">var yqlURL = &quot;//query.yahooapis.com/v1/public/yql?&quot;;

var WeatherViewModel = can.DefineMap.extend({
  location: &quot;string&quot;,
  get placesPromise(){
    if(this.location &amp;&amp; this.location.length &gt; 2) {
      return fetch(
          yqlURL+
          can.param({
            q: 'select * from geo.places where text=&quot;'+this.location+'&quot;',
            format: &quot;json&quot;
          })
      ).then(function(response){
          return response.json();
      }).then(function(data){
          console.log(data);
          if(Array.isArray(data.query.results.place)) {
            return data.query.results.place;
          } else {
            return [data.query.results.place];
          }
      });
    }
  },
  place: &quot;any&quot;,
  pickPlace: function(place){
    this.place = place;
  },
  get forecastPromise(){
    if( this.place ) {
      return fetch(
          yqlURL+
          can.param({
            q: 'select * from weather.forecast where woeid='+this.place.woeid,
            format: &quot;json&quot;
          })
      ).then(function(response){
          return response.json();
      }).then(function(data){
        console.log(&quot;forecast data&quot;, data);
        var forecast = data.query.results.channel.item.forecast;

        return forecast;
      });
    }
  },
  toClassName: function(text){
    return text.toLowerCase().replace(/ /g, &quot;-&quot;);
  }
});

var vm = new WeatherViewModel();

var template = can.stache.from(&quot;app-template&quot;);
var frag = template( vm );
document.body.appendChild(frag);
</code></pre>
<p><span line-highlight='29-49,only'></span></p>
<h2>Hide the forecast if the user changes the entered location</h2>
<h3>The problem</h3>
<p>Currently, if the user changes the entered location, the weather forecast for the
other city is still visible.  Let’s hide it!</p>
<h3>Things to know</h3>
<ul>
<li><p><code>DefineMap</code> <a href="../../can-define.types.set.html" title="Specify what happens when a property value is set.">setter</a>'s can be used to add behavior when a property is set like:</p>
<pre><code class="language-js">var MessageViewModel = can.DefineMap.extend({
  message: {
    type: &quot;string&quot;,
    set: function(){
      this.metaData = null;
    }
  },
  metaData: &quot;any&quot;,
});
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Update the <code>JS</code> tab to:</p>
<ol>
<li>Set the <code>place</code> property to null when the <code>location</code> changes.</li>
</ol>
<pre><code class="language-js">var yqlURL = &quot;//query.yahooapis.com/v1/public/yql?&quot;;

var WeatherViewModel = can.DefineMap.extend({
  location: {
    type: &quot;string&quot;,
    set: function(){
      this.place = null;
    }
  },
  get placesPromise(){
    if(this.location &amp;&amp; this.location.length &gt; 2) {
      return fetch(
          yqlURL+
          can.param({
            q: 'select * from geo.places where text=&quot;'+this.location+'&quot;',
            format: &quot;json&quot;
          })
      ).then(function(response){
          return response.json();
      }).then(function(data){
          console.log(data);
          if(Array.isArray(data.query.results.place)) {
            return data.query.results.place;
          } else {
            return [data.query.results.place];
          }
      });
    }
  },
  place: &quot;any&quot;,
  pickPlace: function(place){
    this.place = place;
  },
  get forecastPromise(){
    if( this.place ) {
      return fetch(
          yqlURL+
          can.param({
            q: 'select * from weather.forecast where woeid='+this.place.woeid,
            format: &quot;json&quot;
          })
      ).then(function(response){
          return response.json();
      }).then(function(data){
        console.log(&quot;forecast data&quot;, data);
        var forecast = data.query.results.channel.item.forecast;

        return forecast;
      });
    }
  },
  toClassName: function(text){
    return text.toLowerCase().replace(/ /g, &quot;-&quot;);
  }
});

var vm = new WeatherViewModel();

var template = can.stache.from(&quot;app-template&quot;);
var frag = template( vm );
document.body.appendChild(frag);
</code></pre>
<p><span line-highlight='4-9,only'></span></p>
<h2>Skip selecting a place if only one place matches the entered location</h2>
<h3>The problem</h3>
<p>If a single place is returned for the entered location, we can skip asking the
user to select their place; instead, we should show the forecast immediately.</p>
<h3>Things to know</h3>
<ul>
<li><p><code>can.DefineMap</code> <a href="../../can-define.types.get.html" title="Specify what happens when a certain property is read on a map. get functions
work like a can-compute and automatically update themselves when a dependent
observable value is changed.">getters</a> are passed their last set value.  This way, the
property can be derived from either the set value or other properties.</p>
<pre><code class="language-js">var MessageVM = can.DefineMap.extend({
  username: &quot;string&quot;,
  message: {
    get: function(lastSet) {
      if(lastSet) {
        return lastSet;
      } else {
        return &quot;Hello &quot;+this.username;
      }
    }
  }
});

var messageVM = new MessageVM({username: &quot;Hank&quot;});
messageVM.message //-&gt; &quot;Hello Hank&quot;;

messageVM.message = &quot;Welcome to Earth&quot;;
messageVM.message //-&gt; &quot;Welcome to Earth&quot;
</code></pre></li>
<li><p>Use <a href="../../can-define.types.get.html" title="Specify what happens when a certain property is read on a map. get functions
work like a can-compute and automatically update themselves when a dependent
observable value is changed.">asynchronous getters</a> to derive data from asynchronous sources.  For example:</p>
<pre><code class="language-js">var MessageVM = can.DefineMap.extend({
  messageId: &quot;string&quot;,
  message: {
    get: function(lastSet, resolve) {
      fetch(&quot;/message/&quot;+this.messageId)
      .then(function(response){
        return response.json();
      }).then(resolve);
    }
  }
});
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Update the template in the <code>HTML</code> tab to:</p>
<ol>
<li>Use a <code>showPlacePicker</code> property to determine if we should show the <code>place</code> picker list.</li>
</ol>
<pre><code class="language-html">&lt;script id=&quot;app-template&quot; type=&quot;text/stache&quot;&gt;
  &lt;div class=&quot;weather-widget&quot;&gt;
    &lt;div class=&quot;location-entry&quot;&gt;
      &lt;label for=&quot;location&quot;&gt;Enter Your location:&lt;/label&gt;
      &lt;input id=&quot;location&quot; {^$value}=&quot;location&quot; type=&quot;text&quot;/&gt;
    &lt;/div&gt;

    {{#if placesPromise.isPending}}
      &lt;p class=&quot;loading-message&quot;&gt;
        Loading places…
      &lt;/p&gt;
    {{/if}}

    {{#if placesPromise.isResolved}}
      {{#if showPlacePicker}}
        &lt;div class=&quot;location-options&quot;&gt;
          &lt;label&gt;Pick your place:&lt;/label&gt;
          &lt;ul&gt;
            {{#each placesPromise.value}}
              &lt;li ($click)=&quot;../pickPlace(this)&quot;&gt;
                {{name}}, {{admin1.content}}, {{country.code}} ({{placeTypeName.content}})
              &lt;/li&gt;
            {{/each}}
          &lt;/ul&gt;
        &lt;/div&gt;
      {{/if}}
    {{/if}}

    {{#if place}}
      &lt;div class=&quot;forecast&quot;&gt;
        &lt;h1&gt;10-day {{place.name}} Weather Forecast&lt;/h1&gt;
        &lt;ul&gt;
          {{#each forecastPromise.value}}
            &lt;li&gt;
              &lt;span class='date'&gt;{{date}}&lt;/span&gt;
              &lt;span class='description {{toClassName(text)}}'&gt;{{text}}&lt;/span&gt;
              &lt;span class='high-temp'&gt;{{high}}&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
              &lt;span class='low-temp'&gt;{{low}}&lt;sup&gt;&amp;deg;&lt;/sup&gt;&lt;/span&gt;
            &lt;/li&gt;
          {{/each}}
        &lt;/ul&gt;
      &lt;/div&gt;
    {{/if}}
  &lt;/div&gt;
&lt;/script&gt;
</code></pre>
<p><span line-highlight='15,26,only'></span>
Update the <code>JS</code> tab to:</p>
<ol>
<li>Define a <code>places</code> property that will have the places list returned by the <code>YQL</code> service.</li>
<li>Define a <code>showPlacePicker</code> property that is true if there’s more than one place in <code>places</code> and
the <code>place</code> property hasn’t been set yet.</li>
<li>Update the <code>place</code> property to default to the first item in <code>places</code> if there is only one item.</li>
</ol>
<pre><code class="language-js">var yqlURL = &quot;//query.yahooapis.com/v1/public/yql?&quot;;

var WeatherViewModel = can.DefineMap.extend({
  location: {
    type: &quot;string&quot;,
    set: function(){
      this.place = null;
    }
  },
  get placesPromise(){
    if(this.location &amp;&amp; this.location.length &gt; 2) {
      return fetch(
          yqlURL+
          can.param({
            q: 'select * from geo.places where text=&quot;'+this.location+'&quot;',
            format: &quot;json&quot;
          })
      ).then(function(response){
          return response.json();
      }).then(function(data){
          console.log(data);
          if(Array.isArray(data.query.results.place)) {
            return data.query.results.place;
          } else {
            return [data.query.results.place];
          }
      });
    }
  },
  places: {
    get: function(latSet, resolve){
      if(this.placesPromise) {
        this.placesPromise.then(resolve)
      }
    }
  },
  get showPlacePicker(){
    return !this.place &amp;&amp; this.places &amp;&amp; this.places.length &gt; 1;
  },
  place: {
    type: &quot;any&quot;,
    get: function(lastSet){
      if(lastSet) {
        return lastSet;
      } else {
        if(this.places &amp;&amp; this.places.length === 1) {
          return this.places[0];
        }
      }
    }
  },
  pickPlace: function(place){
    this.place = place;
  },
  get forecastPromise(){
    if( this.place ) {
      return fetch(
          yqlURL+
          can.param({
            q: 'select * from weather.forecast where woeid='+this.place.woeid,
            format: &quot;json&quot;
          })
      ).then(function(response){
          return response.json();
      }).then(function(data){
        console.log(&quot;forecast data&quot;, data);
        var forecast = data.query.results.channel.item.forecast;

        return forecast;
      });
    }
  },
  toClassName: function(text){
        return text.toLowerCase().replace(/ /g, &quot;-&quot;);
  }
});

var vm = new WeatherViewModel();

var template = can.stache.from(&quot;app-template&quot;);
var frag = template( vm );
document.body.appendChild(frag);
</code></pre>
<p><span line-highlight='30-51,only'></span></p>
<h2>Result</h2>
<p>When finished, you should see something like the following JS Bin:</p>
<p><a class="jsbin-embed" href="https://jsbin.com/vujugel/1/embed?js,output">JS Bin on jsbin.com</a></p>
<script src="https://static.jsbin.com/js/embed.min.js?3.35.5"></script>

</section>

  


<script type="text/javascript">
  window.docObject = {"src":{"path":"docs/can-guides/commitment/recipes/weather-report/weather-report.md"},"description":"This guide walks you through building a simple weather report widget.  It takes about 25 minutes to complete.  It was written with\nCanJS 3.5.\n\n","name":"guides/recipes/weather-report-simple","title":"Weather Report Guide (Simple)","type":"page","parent":"guides/recipes","comment":" ","pathToRoot":"../.."};
</script>
</article>
	  
        <footer><p>CanJS is part of <a href="https://donejs.com" target="_blank">DoneJS</a>. Created and maintained by the core <a href="https://donejs.com/About.html#team" target="_blank">DoneJS team</a> and <a href="https://www.bitovi.com" target="_blank">Bitovi</a>. <strong>Currently 3.8.1.</strong></p>
</footer>
	      </div>
  </div>
</div>

		
			<script>
				steal = {
				  	instantiated: {
				    	"bundles/bit-docs-site/static.css!$css" : null
				  	}
			  	};
			</script>
			<script type='text/javascript' data-main="bit-docs-site/static" src="../../static/node_modules/steal/steal.production.js"></script>
		
		<script async defer src="https://buttons.github.io/buttons.js"></script>

		<!-- root-level elements with attributes necessary for the app -->
		<div path-prefix="../.." />
		
	</body>
</html>
